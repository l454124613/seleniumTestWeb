function showidea(a){forfirstfun();var b="";b="1"==a?base('                        <th style="width: 40px">#</th>\n                        <th >用户</th>\n                        <th >标题</th>\n                        <th >状态</th>\n                        <th >提交时间</th>\n                        <th >备注</th>\n                        <th >操作</th>\n',7,"up()","回到顶部","tlog","2a2"):base('                        <th style="width: 40px">#</th>\n                        <th >标题</th>\n                        <th >状态</th>\n                        <th >提交时间</th>\n                        <th >备注</th>\n                        <th >操作</th>\n',6,"up()","回到顶部","tlog","2a2"),$("#context").html(b),$("#tlog").html("嘘~还没有写这个功能呢，等等")}function showhelp(a){"1"==a?window.open("/html/helpme.html"):window.open("/html/helpme.html")}function ueswidth(){var a=($("#context").outerWidth(!0)-$("#context").outerWidth())/2;209>=a&&hidemenu()}function changealert(){0==alertftype?($("#al").text("切换到alert提示"),alertftype=1):(alertftype=0,$("#al").text("切换到console提示"))}function alertf(a){0==alertftype?alert(a):console.log(a)}function base(a,b,c,d,e,f){var g="<table class=\"ui very compact celled selectable  sortable single line table\"  style='z-index: 19' >\n                    <thead>\n                    <tr>\n"+a+"                    </tr>\n"+"                    </thead>\n"+'                    <tbody id="'+e+'">\n'+"                    <tr>\n"+"\n"+'                        <td colspan="'+b+'">loading......</td>\n'+"                        \n"+"                    </tr>\n"+"\n"+"                    </tbody>\n"+'                    <tfoot class="full-width">\n'+"\n"+"                    <tr>\n"+"\n"+'                        <th colspan="'+b+'">\n'+"                            <div class=\"ui  floated small primary labeled icon button\" id='myaddbutton' onclick='"+c+"' ><i class=\""+("2a2"===f?"radio icon":"plus icon")+'"></i>'+d+"</div>\n"+"                          \n"+"                        </th>\n"+"                    </tr>\n"+"                    </tfoot>\n"+"                </table>\n";return g}function clickurl(){if(1>tid)alertf("请先选择项目~");else{forfirstfun();var a=base('                        <th style="width: 40px">#</th>\n                        <th  >URL</th>\n                        <th style="width: 80px">操作按钮</th>',4,"addURL()","添加链接","urlid");$("#context").html(a),shuaurl()}}function addURL(){0!=isadd?up():("无相关信息"==$("#urlid").html()&&$("#urlid").html(""),$("#urlid").prepend('<tr><td>+</td><td><div class="ui input fluid">\n  <input type="text" id=\'inu\' placeholder="Url">\n</div></td><td><button class="ui  circular basic icon button" onclick="updateeurl(-1)" title="添加用例"><i class="checkmark icon green"></i></button>\n                            <button class="ui circular basic icon button " onclick=\'shuaurl()\' title="返回"><i class="reply icon"></i></button></td></tr>'),isadd=1,up())}function openupdateeurl(a,b){isadd=1;var c=$(b).parent().prev().text();$(b).parent().prev().html('<div class="ui input fluid">\n  <input type="text" id=\'inu\' value=\''+c+'\' placeholder="Url">\n'+"</div>"),$(b).parent().html('<button class="ui  circular basic icon button" onclick="updateeurl('+a+')" title="添加用例"><i class="checkmark icon green"></i></button>\n'+'                            <button class="ui circular basic icon button " onclick=\'shuaurl()\' title="返回"><i class="reply icon"></i></button>')}function removeeurl(a){confirm("你确定要删除吗？")&&$.get("/removeeurl/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),shuaurl(),void 0)})}function updateeurl(a){var b=$.trim($("#inu").val());""!=b?(isadd=0,-1==a&&(a=0),$.post("/updateeurl",{url:b,tid:tid,type:a},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuaurl(),alertf(c.msg),void 0)})):alertf("输入信息不全，请检查")}function shuaurl(){isadd=0,$.get("/geurls/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.urls,d.length>0){for(e="",f=0;f<d.length;f++)e+="                    <tr>\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+d[f].value2+"</td>\n"+'                        <td  ><button class="ui  circular basic icon button" onclick="openupdateeurl('+d[f].value+',this)" title="修改用例"><i class="paint brush icon"></i></button>\n'+'                            <button class="ui circular basic icon button " onclick=\'removeeurl('+d[f].value+')\' title="删除用例"><i class="remove circle icon red"></i></button></td>'+"                    </tr>\n";$("#urlid").html(e),$("table").tablesort()}else $("#urlid").html("无相关信息")})}function changeyan2(){var a=' <div class="ui segment"><div class="ui form">\n            <div class="field">\n                <div class="fields">\n\n                    <div class="four wide field">\n                        <div class="ui fluid search selection  dropdown" id=\'sedatass\'>\n                            <input type="hidden" name="country" id=\'datass\'>\n                            <i class="dropdown icon"></i>\n                            <div class="default text">选择数据库</div>\n                            <div class="menu" id=\'sedatas\'>\n\n\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="twelve wide field " id=\'inputsql\'>\n                        <input type="text"   placeholder="sql语句,例如：select a,b,c from d" id=\'inputvsql\'>\n                    </div>\n\n                </div>\n            <div class="field">\n                        <input type="text"   placeholder="结果:多个结果验证，使用、（顿号）区分，例如：a=xxx、b=xxx、c=xxx" id=\'vsql\'>\n                </div>\n    </div></div>';$("#yanid").html(a),$.get("/getdatasource/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if("0"!=c.isok)alertf(c.msg);else{for(d=c.datasources,e="",f=0;f<d.length;f++)e+='                                <div class="item" data-value="'+d[f].id+'">'+d[f].name+"</div>\n";$("#sedatas").html(e),$("#sedatass").dropdown(),-1!=exptmp.a&&2==exptmp.type&&($("#sedatass").dropdown("set selected",exptmp.a),$("#inputvsql").val(exptmp.b),$("#vsql").val(exptmp.c))}})}function changeyan3(){var a=' <div class="ui segment" style=\'margin: 1rem\'><div class="ui form">\n            <div class="field">\n                <div class="fields">\n\n                    <div class="four wide field">\n                        <div class="ui fluid search selection  dropdown" id=\'sehttp\'>\n                            <input type="hidden" name="country" id=\'http\'>\n                            <i class="dropdown icon"></i>\n                            <div class="default text">发送方式</div>\n                            <div class="menu" >\n                                <div class="item" data-value="1">get</div>\n                                <div class="item" data-value="2">post</div>\n\n\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="twelve wide field " id=\'urlid\'>\n                        <input type="text"   placeholder="链接:http(s):" id=\'urlv\'>\n                    </div>\n\n                </div>\n            <div class="field">\n<label>传输内容，如有头文件，使用格式：HEAD{xxx:aaa&ccc:222}xxx=111&ccc=222</label><textarea id=\'areaid\'></textarea>                </div>\n            <div class="field">\n                <label>值</label>\n                <div class="fields">\n\n                    <div class="four wide field">\n                        <div class="ui fluid search selection  dropdown" id=\'setype3\'>\n                            <input type="hidden" name="country" id=\'type3\'>\n                            <i class="dropdown icon"></i>\n                            <div class="default text">选择类型</div>\n                            <div class="menu">\n                                <div class="item" data-value="1">等于</div>\n                                <div class="item" data-value="2">不等于</div>\n                                <div class="item" data-value="3">包含</div>\n                                <div class="item" data-value="4">不包含</div>\n\n\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="twelve wide field " id=\'input2\'>\n                        <input type="text"   placeholder="值的内容" id=\'inputv3\'>\n                    </div>\n\n                </div>\n            </div>\n    </div></div>';$("#yanid").html(a),$("#sehttp").dropdown(),$("#setype3").dropdown(),-1!=exptmp.a&&3==exptmp.type&&($("#sehttp").dropdown("set selected",exptmp.a),$("#setype3").dropdown("set selected",exptmp.d),$("#areaid").val(exptmp.c.toString().replace(/<br\/>/g,"\n")),$("#urlv").val(exptmp.b),$("#inputv3").val(exptmp.e))}function changeyan4(){$("#yanid").html(""),exptmp={a:-1,b:-1,c:-1,d:-1,e:-1,type:0}}function shualabel(){$.get("/getlabel/"+tid,function(a,b){var c,d,e,f,h;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.labels,d.length>0){for(e="",f=0;f<d.length;f++)"'"+d[f].cids+"',"+d[f].id,h=d[f].id+",'"+d[f].name+"','"+d[f].des+"'",e+="                    <tr>\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+d[f].name+"</td>\n"+"                        <td  >"+d[f].des+"</td>\n"+'                        <td  ><button class="ui  circular basic icon button" onclick="updatelabel('+h+')" title="修改用例"><i class="paint brush icon"></i></button>\n'+'                            <button class="ui circular basic icon button " onclick=\'removelabel('+d[f].id+')\' title="删除用例"><i class="remove circle icon red"></i></button></td>'+"                    </tr>\n";$("#labelid").html(e),$("table").tablesort()}else $("#labelid").html("无相关信息")})}function clicklabel(){if(1>tid)alertf("请先选择项目~");else{forfirstfun();var a=base('                        <th style="width: 40px">#</th>\n                        <th  style="width: 25%">标签名称</th>\n                        <th   style=\'min-width: 100px\'>标签描述</th>\n                        <th style="width: 80px">操作按钮</th>',4,"addlabel()","添加标签","labelid");$("#context").html(a),shualabel()}}function changeyan1(){var a=' <div class="ui segment"><div class="ui form">\n            <div class="three fields">\n                <div class="field">\n                    <label>页面(必须选择当前页面)</label>\n                    <div class="ui fluid search selection  dropdown" id=\'sepage2\'>\n                        <input type="hidden" onchange=\'changepage2(this)\' id=\'page2v\' name="country">\n                        <i class="dropdown icon"></i>\n                        <div class="default text">选择页面...</div>\n                        <div class="menu" id=\'addpage2\'>\n                        </div>\n                        </div>\n                </div>\n                <div class="field">\n                    <label>元素</label>\n                    <div class="ui fluid search selection disabled dropdown" id=\'seele2\'>\n                        <input type="hidden" onchange=\'changeele2(this)\' id=\'ele2v\'>\n                        <i class="dropdown icon"></i>\n                        <div class="default text">选择元素...</div>\n                        <div class="menu" id=\'addele2\'>\n                        </div>\n                    </div>\n                </div>\n                <div class="field">\n                    <label>操作</label>\n                    <div class="ui fluid search selection disabled dropdown" id=\'seact2\'>\n                        <input type="hidden" name="country" onchange=\'changeact2(this)\' id=\'act2v\'>\n                        <i class="dropdown icon"></i>\n                        <div class="default text">选择操作...</div>\n                        <div class="menu" id=\'addact2\'>\n                                <div class="item" data-value="7">存在</div>\n                                <div class="item" data-value="8">获取文本</div>\n                                <div class="item" data-value="9">获取输入值</div>\n                                <div class="item" data-value="10">获取文本（alert）</div>\n                                <div class="item" data-value="11">可用</div>\n                                <div class="item" data-value="12">被选中</div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="field">\n                <label>值</label>\n                <div class="fields">\n\n                    <div class="four wide field">\n                        <div class="ui fluid search selection disabled dropdown" id=\'setype2\'>\n                            <input type="hidden" name="country" id=\'type2\'>\n                            <i class="dropdown icon"></i>\n                            <div class="default text">选择类型</div>\n                            <div class="menu">\n                                <div class="item" data-value="1">等于</div>\n                                <div class="item" data-value="2">不等于</div>\n                                <div class="item" data-value="3">包含</div>\n                                <div class="item" data-value="4">不包含</div>\n\n\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="twelve wide field disabled" id=\'input2\'>\n                        <input type="text"   placeholder="值的内容" id=\'inputv2\'>\n                    </div>\n\n                </div>\n            </div>\n    </div></div>';$("#yanid").html(a),$(".dropdown").dropdown(),$.get("/gpage/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else{for(d=c.pages,e="",f=0;f<d.length;f++)e+='<div class="item" data-value="'+d[f].id+'">'+d[f].pagename+"</div>\n";$("#addpage2").html(e),$("#sepage2").dropdown(),-1!=exptmp.a&&1==exptmp.type&&$("#sepage2").dropdown("set selected",exptmp.a)}})}function changepage2(a){$("#seele2").dropdown("clear");var b=$(a).val();$("#seele2").removeClass("disabled"),$.get("/gele/"+b+"/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else{for(d=c.elements,e="",f=0;f<d.length;f++)e+='<div class="item" data-value="'+d[f].id+'">'+d[f].name+"</div>\n";$("#addele2").html(e),-1!=exptmp.b&&($("#seele2").dropdown(),$("#seele2").dropdown("set selected",exptmp.b))}})}function changeele2(a){$("#seact2").dropdown("clear");var b=$(a).val();$("#seact2").removeClass("disabled"),""!=b&&-1!=exptmp.c&&($("#seact2").dropdown(),$("#seact2").dropdown("set selected",exptmp.c),("8"==exptmp.c||"9"==exptmp.c||"10"==exptmp.c)&&($("#setype2").dropdown(),$("#setype2").dropdown("set selected",exptmp.d),$("#inputv2").val(exptmp.e)),exptmp={a:-1,b:-1,c:-1,d:-1,e:-1})}function changeact2(a){$("#setype2").dropdown("clear"),$("#inputv2").val("");var b=$(a).val();"8"==b||"9"==b||"10"==b?($("#setype2").removeClass("disabled"),$("#input2").removeClass("disabled")):($("#setype2").addClass("disabled"),$("#input2").addClass("disabled"))}function getyan1(){var a=$("#page2v").val(),b=$("#ele2v").val(),c=$("#act2v").val(),d=$("#type2").val(),e=$.trim($("#inputv2").val());return""==a||""==b||""==c?!1:"5"==c?""==d||""==e?!1:{a:a,b:b,c:c,d:d,e:e,type:1,sid:stepid}:{a:a,b:b,c:c,d:d,e:e,type:1,sid:stepid}}function getyan2(){var a=$("#datass").val(),b=$.trim($("#inputvsql").val()),c=$.trim($("#vsql").val());return""==a||""==b||""==c?!1:{a:a,b:b,c:c,d:-1,e:-1,type:2,sid:stepid}}function getyan3(){var a=$("#http").val(),b=$("#type3").val(),c=$.trim($("#areaid").val()),d=$.trim($("#urlv").val()),e=$.trim($("#inputv3").val());return""==a||""==e||""==b||""==d?!1:{a:a,b:d,c:c,d:b,e:e,type:3,sid:stepid}}function forfirstfun(a){ueswidth(),1===a||(int1=window.clearInterval(int1))}function up(){$("html,body").animate({scrollTop:0},500)}function clicklog(){forfirstfun();var a=base('                        <th style="width: 40px">#</th>\n                        <th >用户名称</th>\n                        <th >用户邮箱</th>\n                        <th >操作时间</th>\n                        <th >操作内容</th>\n                        <th style="width: 80px">数据库id</th>\n',6,"up()","回到顶部","tlog","2a2");$("#context").html(a),shualog()}function clickfile(){if(1>tid)alertf("请先选择项目~");else{forfirstfun();var a=base('                        <th style="width: 40px">#</th>\n                        <th >文件名称</th>\n                        <th >文件大小</th>\n                        <th >上传人</th>\n                        <th >上传时间</th>\n                        <th style="width: 80px">操作</th>\n',6,"addfile(0)","添加文件","tfile");$("#context").html("(上传文件要求大小不大于10M，如果有大文件或者大量文件，请联系管理员)"+a+"<input type='file' id='fileupload' onchange='changefile()' style='display: none'>"),shuafile()}}function changefile(){var b,a=$("#fileupload").get(0).files[0];return a.size>10485750?(alertf("文件过大，无法上传，请联系管理员处理"),0):(b=new FormData,b.append("file",a),$.ajax({url:"/upload/"+fileid+"/"+tid,type:"POST",cache:!1,data:b,processData:!1,contentType:!1,beforeSend:function(){$("#myaddbutton").addClass("loading")},success:function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):($("#myaddbutton").removeClass("loading"),alertf(c.msg),shuafile(),void 0)}}),void 0)}function addfile(a){fileid=a,$("#fileupload").click()}function shuafile(){$.get("/getfile/"+tid,function(a,b){var c,d,e,f,g;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.files,e="",d.length>0){for(f=0;f<d.length;f++)g=d[f].size,g>1023?g=g>1048575?(g/1024/1024).toFixed(2)+"MB":(g/1024).toFixed(2)+"KB":g+="B",e+="                    <tr>\n\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+d[f].name+"</td>\n"+"                        <td  >"+g+"</td>\n"+"                        <td  >"+d[f].user+"</td>\n"+"                        <td  >"+d[f].time+"</td>\n"+'                        <td  ><a class="ui  circular basic  icon button" href="/Download/'+d[f].id+"/"+d[f].name+'/filename"  title="下载文件"><i class="download icon"></i></a>'+'<button class="ui  circular basic  icon button" onclick="addfile('+d[f].id+')" title="修改文件"><i class="paint brush icon"></i></button>\n'+'                            <button class="ui circular basic icon button " onclick=\'removefile('+d[f].id+')\' title="删除文件"><i class="remove circle icon red"></i></button></td>\n'+"                    </tr>\n";$("#tfile").html(e),$("table").tablesort()}else $("#tfile").html("无相关信息")})}function downloadfile(a,b){$.get("/Download/"+a+"/"+b+"/"+"filename",function(a,b){"success"==b||alertf("网站出错，请联系管理员")})}function removefile(a){confirm("你确定要删除吗？")&&$.get("/removefile/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),shuafile(),void 0)})}function clickslog(){forfirstfun();var a=base('                        <th style="width: 40px">#</th>\n                        <th >用户名称</th>\n                        <th >用户邮箱</th>\n                        <th >操作时间</th>\n                        <th >操作内容</th>\n                        <th style="width: 80px">数据库id</th>\n                        <th style="width: 80px">当前状态</th>\n',7,"up()","回到顶部","tlog","2a2");$("#context").html(a),shuaslog()}function clickmanage(){var a,b;forfirstfun(),a=base('                        <th style="width: 40px">#</th>\n                        <th >用户名称</th>\n                        <th >用户邮箱</th>\n                        <th style="width: 200px">最后登录时间</th>\n                        <th style="width: 80px">是否管理员</th>\n                        <th style="width: 80px">是否禁用</th>\n                        <th style="width: 80px">操作</th>\n',7,"adduser()","添加用户","tuser"),b='<div id=\'mett\' class="ui top attached tabular menu">\n  <a class="active item" onclick=\'shuauser()\' data-tab="first">用户管理</a>\n  <a class="item" data-tab="second" onclick=\'shuaitem()\'>项目管理</a>\n  <a class="item  " data-tab="third"  >其他设置</a>\n</div>\n<div class="ui bottom attached active tab segment" data-tab="first">\n(想要删除用户，请在数据表中操作)'+a+"</div>\n"+'<div class="ui bottom attached tab segment" data-tab="second">\n'+"(想要删除项目，请在数据表中操作)"+base("                        <th style=\"width: 40px\">#</th>\n                        <th style='max-width: 15%'>项目名称</th>\n                        <th style='max-width:40%'>项目首页链接</th>\n                        <th style='max-width:20%'>参与用户</th>\n                        <th style=\"width: 80px\">是否禁用</th>\n                        <th style=\"width: 80px\">操作</th>\n",6,"additem()","添加项目","titem")+"</div>\n"+'<div class="ui bottom attached tab segment" data-tab="third">\n'+'<div class="ui middle aligned divided list">\n'+'  <div class="item">\n'+'    <div class="right floated content">\n'+"      <div class=\"ui button\"  onclick='clearIsused()'>清除</div>\n"+"    </div>\n"+'   <div class="header">清除无用数据</div>为减少数据库的空间，清除isused字段为0的数据（用户和项目表除外），无法恢复，请慎重! '+"  </div>\n"+'  <div class="item">\n'+'    <div class="right floated content">\n'+"      <div class=\"ui button\"  onclick='stoprunningcase()'>强制处理</div>\n"+"    </div>\n"+'   <div class="header">解决运行卡住的问题</div>在运行用例和调试用例时，会出现无法退出，或强制退出后，无法再运行的问题，此处强制终止。会影响到其他正在运行的用，请确保无人在使用，才去点击。 '+"  </div>\n"+'  <div class="item">\n'+'    <div class="right floated content">\n'+'      <div class="ui button disabled">备用</div>\n'+"    </div>\n"+'   <div class="header">备用</div>备用'+"  </div>\n"+"</div>"+"</div>",$("#context").html(b),$("#mett .item").tab(),shuauser()}function stoprunningcase(){$.post("/stoprunningcase",{mimi:compileStr(Date.parse(new Date)/1e3+"")},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),void 0)})}function clearIsused(){$.post("/clearisused",{mimi:compileStr(Date.parse(new Date)/1e3+"")},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),void 0)})}function runcase(a,b){$.get("/testcase/"+a+"/"+tid+"/"+b,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),void 0)})}function lookruncase(a){Cookies.set("log",a+"qbwd90211j1qwdsqjwe1me01"+tid),window.open("/html/log.html")}function shuauser(){$.get("/getuser",function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.users,user1=d,e="",d.length>0){for(f=0;f<d.length;f++)e+="                    <tr>\n\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+("null"==d[f].name?"":d[f].name)+"</td>\n"+"                        <td  >"+d[f].email+"</td>\n"+"                        <td  >"+("null"==d[f].lastlogintime?"":d[f].lastlogintime)+"</td>\n"+"                        <td  >"+("1"==d[f].ismanager)+"</td>\n"+"                        <td  >"+("0"==d[f].isused)+"</td>\n"+'                        <td  ><button class="ui  circular basic icon button" onclick="updateuser('+d[f].id+","+d[f].ismanager+",'"+d[f].name+"','"+d[f].email+'\')" title="修改用户"><i class="paint brush icon"></i></button>\n'+'                            <button class="ui circular basic icon button '+("0"==d[f].isused?"disabled":"")+"\" onclick='removeuser("+d[f].id+')\' title="禁用用户"><i class="remove circle icon red"></i></button></td>\n'+"                    </tr>\n";$("#tuser").html(e),$("table").tablesort()}else $("#tuser").html("无相关信息")})}function shualog(){$.get("/getlog",function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.logs,e="",d.length>0){for(f=0;f<d.length;f++)e+="                    <tr>\n\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+d[f].name+"</td>\n"+"                        <td  >"+d[f].user+"</td>\n"+"                        <td  >"+d[f].time+"</td>\n"+"                        <td  >"+d[f].log+"</td>\n"+"                        <td  >"+d[f].id+"</td>\n"+"                    </tr>\n";$("#tlog").html(e),$("table").tablesort()}else $("#tlog").html("无相关信息")})}function shuaslog(){$.get("/getslog",function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.logs,e="",d.length>0){for(f=0;f<d.length;f++){switch(rr2="",d[f].status){case"1":rr2="<div  title='点击修改状态' style='color: red' onclick='changedo("+d[f].id+")'>未处理</div>";break;case"2":rr2="<div style='color: green'>已处理</div>"}e+="                    <tr>\n\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+d[f].name+"</td>\n"+"                        <td  >"+d[f].user+"</td>\n"+"                        <td  >"+d[f].time+"</td>\n"+"                        <td  >"+d[f].log+"</td>\n"+"                        <td  >"+d[f].id+"</td>\n"+"                        <td  >"+rr2+"</td>\n"+"                    </tr>\n"}$("#tlog").html(e),$("table").tablesort()}else $("#tlog").html("无相关信息")})}function changedo(a){$.get("/updatelid/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),shuaslog(),void 0)})}function shwomenu(){$("#menu1").css("display","block"),$("#showmenu").css("display","none")}function hidemenu(){$("#menu1").css("display","none"),$("#showmenu").css("display","block")}function shuastep(){$.get("/getstep/"+cid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.steps,e="",d.length>0){for(f=0;f<d.length;f++)e+="                    <tr>\n\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+d[f].pagename+"</td>\n"+"                        <td  >"+d[f].ename+"</td>\n"+"                        <td  >"+in2st4action(d[f].catid)+"</td>\n"+"                        <td  >"+("null"==d[f].value?"":d[f].value)+"</td>\n"+'                        <td  ><button class="ui circular basic icon button " onclick=\'showexp('+d[f].id+')\' title="设置期望结果"><i class="align justify icon"></i></button></td>\n'+'                        <td  ><button class="ui  circular basic icon button addstep1" '+(9==d[f].type?"style='display: none'":"")+"  onclick='addNowStep("+(f+1)+",this,"+d[f].id+","+d[f].step+')\' title="添加"><i class="plus icon green"></i></button>'+'<button class="ui  circular basic icon button" onclick="updatestep(this,'+d[f].id+","+(f+1)+","+d[f].eid+","+d[f].catid+",'"+d[f].value+'\')" title="修改"><i class="paint brush icon"></i></button>\n'+'                            <button class="ui circular basic icon button " onclick=\'removestep('+d[f].id+')\' title="删除"><i class="remove circle icon red"></i></button></td>\n'+"                    </tr>\n";$("#stepid").html(e),$("table").tablesort(),$(".ui.dropdown").dropdown()}else e='                    <tr>\n\n                        <td  >1</td>\n                        <td  ><div id=\'pagename2\'></div></td>\n                        <td  ><div class="ui selection dropdown" id=\'seele\'>\n  <input type="hidden"  id=\'elev\' name="ele">\n  <div class="default text">元素</div>\n  <i class="dropdown icon"></i>\n  <div class="menu" id=\'eleg\'>\n  </div>\n</div></td>\n <td  ><div class="ui selection dropdown " id=\'actid\' style=\'min-width: 9em\'>\n  <input type="hidden" onchange=\'changeact(this)\' id=\'actv\' name="act">\n  <div class="default text">操作</div>\n  <i class="dropdown icon"></i>\n  <div class="menu" id=\'actg\'>\n    <div class="item" data-value="1">点击</div>\n    <div class="item" data-value="2">输入内容</div>\n    <div class="item" data-value="3">清除</div>\n    <div class="item" data-value="4">上传文件</div>\n    <div class="item" data-value="5">确认（alert）</div>\n    <div class="item" data-value="6">取消（alert）</div>\n  </div>\n</div></td>\n                        <td  >  <div class="ui fluid input disabled  " id=\'inputv\'>\n</div></td>\n                        <td  ><button class="ui circular basic icon button disabled" title="设置期望结果"><i class="align justify icon"></i></button></td>\n                        <td  ><button class="ui  circular basic icon button" onclick="addstep(1)" title="确认"><i class="checkmark icon green"></i></button></td>\n                    </tr>\n',$("#stepid").html(e),shuapageinfo(),$(".ui.dropdown").dropdown()})}function lookpre(a){cid=a,$.get("/getprecondition/"+cid,function(a,b){var c,d;return"success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok?(location.href="/",!1):(d=c.pre,0==d.length?pretmp={a:-1,b:-1,c:-1,type:4}:1==d[0].type?(pretmp={a:d[0].a,b:d[0].b,c:d[0].c,type:d[0].type},$("#yu11").checkbox("check")):2==d[0].type?(pretmp={a:d[0].a,b:d[0].b,c:d[0].c,type:d[0].type},$("#yu22").checkbox("check")):3==d[0].type?(pretmp={a:d[0].a,b:d[0].b,c:d[0].c.replace(/<br\/>/g,"\n").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&dakuohao1/g,"{").replace(/&dakuohao2/g,"}").replace(/&fanxiegang/g,"\\"),type:d[0].type},$("#yu33").checkbox("check")):pretmp={a:-1,b:-1,c:-1,type:4},void 0)}),$("#modal8").modal("show")}function changeyu4(){pretmp={a:-1,b:-1,c:-1,type:4},$("#yuid").html("")}function getyu1(){var a=$("#case2v").val();return""==a?!1:{a:a,b:-1,c:-1,type:1,cid:cid}}function changeyu1(){var a=' <div class="ui segment"><div class="ui form">\n                <div class="field">\n                    <label>用例</label>\n                    <div class="ui fluid search selection  dropdown" id=\'secase2\'>\n                        <input type="hidden"  id=\'case2v\' name="country">\n                        <i class="dropdown icon"></i>\n                        <div class="default text">选择用例...</div>\n                        <div class="menu" id=\'addcase2\'>\n                        </div>\n                        </div>\n                        </div>\n    </div></div>';$("#yuid").html(a),$.get("/getcase/2/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;for(d=c.cases,e="",f=0;f<d.length;f++)e+='<div class="item" data-value="'+d[f].id+'">'+d[f].name+"</div>\n";$("#addcase2").html(e),$(".dropdown").dropdown(),1==pretmp.type&&-1!=pretmp.a&&$("#secase2").dropdown("set selected",pretmp.a)})}function getyu2(){var a=$("#datass").val(),b=$.trim($("#areaid").val());return""==a||""==b?!1:{a:a,b:b,c:-1,type:2,cid:cid}}function changeyu2(){var a=' <div class="ui segment"><div class="ui form">\n            <div class="field">\n   <div class="ui fluid search selection  dropdown" id=\'sedatass\'>\n                            <input type="hidden" name="country" id=\'datass\'>\n                            <i class="dropdown icon"></i>\n                            <div class="default text">选择数据库</div>\n                            <div class="menu" id=\'sedatas\'>\n\n\n                            </div>\n                        </div>\n                </div>\n            <div class="field">\n<label>sql语句，有多句使用;（英文分号）隔开</label><textarea id=\'areaid\'></textarea>                </div>\n    </div></div>';$("#yuid").html(a),$.get("/getdatasource/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if("0"!=c.isok)alertf(c.msg);else{for(d=c.datasources,e="",f=0;f<d.length;f++)e+='                                <div class="item" data-value="'+d[f].id+'">'+d[f].name+"</div>\n";
    $("#sedatas").html(e),$("#sedatass").dropdown(),-1!=pretmp.a&&2==pretmp.type&&($("#sedatass").dropdown("set selected",pretmp.a),$("#areaid").val(pretmp.b.toString().replace(/<br\/>/g,"\n").replace(/%25/g,'"').replace(/%26/g,"'")))}})}function getyu3(){var a=$("#http").val(),b=$.trim($("#urlv").val()),c=$.trim($("#areaid").val());return""==a||""==b||""==c?!1:{a:a,b:b,c:c,type:3,cid:cid}}function changeyu3(){var a=' <div class="ui segment" style=\'margin: 1rem\'><div class="ui form">\n            <div class="field">\n                <div class="fields">\n\n                    <div class="four wide field">\n                        <div class="ui fluid search selection  dropdown" id=\'sehttp\'>\n                            <input type="hidden" name="country" id=\'http\'>\n                            <i class="dropdown icon"></i>\n                            <div class="default text">发送方式</div>\n                            <div class="menu" >\n                                <div class="item" data-value="1">get</div>\n                                <div class="item" data-value="2">post</div>\n\n\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="twelve wide field " id=\'urlid\'>\n                        <input type="text"   placeholder="链接:http(s):" id=\'urlv\'>\n                    </div>\n\n                </div>\n            <div class="field">\n<label>传输内容，如有头文件，使用格式：HEAD{xxx:aaa&ccc:222}xxx=111&ccc=222</label><textarea id=\'areaid\'></textarea>                </div>\n    </div></div>';$("#yuid").html(a),$("#sehttp").dropdown(),-1!=pretmp.a&&3==pretmp.type&&($("#sehttp").dropdown("set selected",pretmp.a),$("#areaid").val(pretmp.c.toString().replace(/<br\/>/g,"\n")),$("#urlv").val(pretmp.b))}function addNowStep(a,b,c,d){$(".addstep1").addClass("disabled"),$.get("/getpid/"+c,function(a,e){var f,g;return"success"==e||alertf("网站出错，请联系管理员"),f=$.parseJSON(a),"3"==f.isok?(location.href="/",!1):(0!=f.isok?alertf(f.msg):f.pid>0&&(pid=f.pid,g='                    <tr>\n\n                        <td  >+</td>\n                        <td  ><div id=\'pagename2\'></div></td>\n                        <td  ><div class="ui selection dropdown" id=\'seele\'>\n  <input type="hidden"  id=\'elev\' name="ele">\n  <div class="default text">元素</div>\n  <i class="dropdown icon"></i>\n  <div class="menu" id=\'eleg\'>\n  </div>\n</div></td>\n <td  ><div class="ui selection dropdown " id=\'actid\' style=\'min-width: 9em\'>\n  <input type="hidden" onchange=\'changeact(this)\' id=\'actv\' name="act">\n  <div class="default text">操作</div>\n  <i class="dropdown icon"></i>\n  <div class="menu" id=\'actg\'>\n    <div class="item" data-value="1">点击</div>\n    <div class="item" data-value="2">输入内容</div>\n    <div class="item" data-value="3">清除</div>\n    <div class="item" data-value="4">上传文件</div>\n    <div class="item" data-value="5">确认（alert）</div>\n    <div class="item" data-value="6">取消（alert）</div>\n  </div>\n</div></td>\n                        <td  >  <div class="ui fluid input disabled" id=\'inputv\'>\n  <input type="text" placeholder="输入值" id=\'inputv2\'>\n</div></td>\n                        <td  ><button class="ui circular basic icon button disabled" title="设置期望结果"><i class="align justify icon"></i></button></td>\n                        <td  ><button class="ui  circular basic icon button" onclick="addstep('+(d+1)+')" title="确认"><i class="checkmark icon green"></i></button>'+'                            <button class="ui circular basic icon button "  onclick=\'closeUpdateStep('+pid+')\' title="取消"><i class="remove circle icon red"></i></button>'+"</td>\n"+"                    </tr>\n",$(b).parent().parent().after(g),$.get("/gettopage/"+c,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(0!=c.isok?alertf(c.msg):(c.topage>0&&(pid=c.topage),shuapageinfo()),void 0)})),void 0)})}function updatestep(a,b,c,d,e,f){var g="                        <td  >"+c+"</td>\n"+'                        <td  ><div id="pagename2"></div></td>\n'+"                        <td  ><div class=\"ui selection dropdown\" id='seele'>\n"+'  <input type="hidden"  id=\'elev\' name="ele">\n'+'  <div class="default text">元素</div>\n'+'  <i class="dropdown icon"></i>\n'+"  <div class=\"menu\" id='eleg'>\n"+"  </div>\n"+"</div></td>\n"+" <td  ><div class=\"ui selection dropdown \" id='actid' style='min-width: 9em'>\n"+"  <input type=\"hidden\" onchange='changeact(this)' id='actv' name=\"act\">\n"+'  <div class="default text">操作</div>\n'+'  <i class="dropdown icon"></i>\n'+"  <div class=\"menu\" id='actg'>\n"+'    <div class="item" data-value="1">点击</div>\n'+'    <div class="item" data-value="2">输入内容</div>\n'+'    <div class="item" data-value="3">清除</div>\n'+'    <div class="item" data-value="4">上传文件</div>\n'+'    <div class="item" data-value="5">确认（alert）</div>\n'+'    <div class="item" data-value="6">取消（alert）</div>\n'+"  </div>\n"+"</div></td>\n"+"                        <td  >  <div class=\"ui fluid input disabled\" id='inputv'>\n"+'  <input type="text" placeholder="输入值" id=\'inputv2\'>\n'+"</div></td>\n"+'                        <td  ><button class="ui circular basic icon button disabled" title="设置期望结果"><i class="align justify icon"></i></button></td>\n'+'                        <td  ><button class="ui  circular basic icon button" onclick="fixstep('+b+')" title="确认"><i class="checkmark icon green"></i></button>'+'                            <button class="ui circular basic icon button "  onclick=\'closeUpdateStep()\' title="取消"><i class="remove circle icon red"></i></button>'+"</td>\n";$(a).parent().parent().html(g),$("#actid").dropdown("set selected",e),$.get("/getpid/"+b,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(0!=c.isok?alertf(c.msg):c.pid>0&&(pid=c.pid),void 0)}),shuapageinfo(d,e,f)}function closeUpdateStep(a){a>0&&(pid=a),lookstep(cid,!0)}function showexp(a){stepid=a,$("#yan44").checkbox("check"),$.get("/getexp/"+a,function(a,b){var c,d,e;return"success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok?(location.href="/",!1):(d=c.exp,1==d.length?(e=d[0],1==e.type?(exptmp={a:e.a,b:e.b,c:e.c,d:e.d,e:e.e,type:1},$("#yan11").checkbox("check")):2==e.type?(exptmp={a:e.a,b:e.b,c:e.c,d:e.d,e:e.e,type:2},$("#yan22").checkbox("check")):3==e.type?(exptmp={a:e.a,b:e.b,c:e.c,d:e.d,e:e.e,type:3},$("#yan33").checkbox("check")):(exptmp={a:-1,b:-1,c:-1,d:-1,e:-1,type:0},$("#yan44").checkbox("check"))):exptmp={a:-1,b:-1,c:-1,d:-1,e:-1,type:0},void 0)}),$("#modal6").modal("show")}function removestep(a){confirm("你确定要删除吗？")&&$.get("/removestep/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuastep(),alertf(c.msg),void 0)})}function fixstep(a){var b=$("#pagename2").text(),c=$("#elev").val(),d=$("#seele").dropdown("get text"),e=$("#actv").val(),f="no";$("#inputv").hasClass("disabled")||(f=$.trim($("#inputv2").val())),""==b||""==c||""==e||""==f?alertf("信息输入不全，请查看"):$.post("/fixstep",{id:a,pagename:b,catid:e,value:"no"==f?"":f,eid:c,ename:d},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuastep(),alertf(c.msg),void 0)})}function addstep(a){var b=$("#pagename2").text(),c=$("#elev").val(),d=$("#seele").dropdown("get text"),e=$("#actv").val(),f="no";$("#inputv").hasClass("disabled")||(f=$.trim($("#inputv2").val())),""==b||""==c||""==e||""==f?alertf("信息输入不全，请查看"):$.post("/addstep",{step:a,pagename:b,catid:e,cid:cid,value:"no"==f?"":f,eid:c,ename:d},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuastep(),alertf(c.msg),void 0)})}function wancheng(){pid=0,$("#mcase").click()}function changeact(a){var b=$(a).val();""!=b&&("2"==b?($("#inputv").removeClass("disabled"),$("#inputv").removeClass("selection"),$("#inputv").removeClass("dropdown"),$("#inputv").html('  <input type="text"  placeholder="输入值" id=\'inputv2\'>')):"4"==b?$.get("/getfile/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else{for(d=c.files,e=' <input type="hidden"  id=\'inputv2\' name="file">\n  <i class="dropdown icon"></i>\n  <div class="default text">选择文件</div>\n  <div class="menu">\n',f=0;f<d.length;f++)e+='    <div class="item" data-value="'+d[f].id+'">'+d[f].name+"</div>\n";e+="  </div>",$("#inputv").addClass("dropdown"),$("#inputv").addClass("selection"),$("#inputv").removeClass("disabled"),$("#inputv").html(e),$("#inputv").dropdown()}}):($("#inputv").addClass("disabled"),$("#inputv").html("")))}function changewait(a){var b=$(a).val();"1"==b||"2"==b?$("#waitd").removeClass("disabled"):($("#sewait").dropdown("clear"),$("#waitd").addClass("disabled"),$("#waitv").val(""))}function changetype(a){var a2,vv2,vv3,i,vv4,a1=""===$("#elev").val()?"a":$("#elev").val(),vv=eval("eles2["+a1+"]");for(vv!=$(a).val()&&$("#seele").dropdown("clear"),a2=in2en4type($(a).val()),vv2=eval('eles["'+a2+'"]'),vv3="",i=0;i<vv2.length;i++)vv4=vv2[i].split("a=a="),vv3+='    <div class="item" data-value="'+vv4[0]+'">'+vv4[1]+"</div>\n";$("#eleg").html(vv3)}function shuapageinfo(a,b,c){$.get("/ge4p/"+pid+"/"+tid+"/"+cid,function(d,e){var f,g;return"success"==e||alertf("网站出错，请联系管理员"),f=$.parseJSON(d),"3"==f.isok?(location.href="/",!1):(0!=f.isok?alertf(f.msg):(g=f.eles,pid=f.page.id,re3="",eles2={},g.forEach(function(a){re3+='    <div class="item" data-value="'+a.id+'">'+a.name+"</div>\n"}),$("#eleg").html(re3),$("#pagename2").text(f.page.pagename),$(".ui.dropdown").dropdown(),""!=a&&(acttionnum=b,$("#seele").dropdown("set selected",a),$("#inputv2").val(c))),void 0)})}function shuapage(){$.get("/gpage/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.pages,pages1=d,e="",d.length>0){for(f=0;f<d.length;f++)e+="<tr><td>"+(f+1)+"</td>\n"+"                        <td>"+d[f].pagename+"</td>\n"+"                        <td>"+d[f].pagetitle+"</td>\n"+'                        <td ><button class="ui circular basic  icon button"  onclick=\'lookelement('+d[f].id+')\' title="查看元素"><i class="hand pointer icon"></i></button></td>\n'+'                        <td><button class="ui  circular basic icon button" onclick=\'updatepage('+d[f].id+',this)\' title="修改页面"><i class="paint brush icon"></i></button>\n'+'                            <button class="ui circular basic icon button" onclick=\'removepage('+d[f].id+')\' title="删除页面"><i class="remove circle icon red"></i></button></td> </tr>';$("#tpageid").html(e),$("table").tablesort()}else $("#tpageid").html("无相关信息")})}function datasourcecon(a,b){$(b).addClass("loading"),$(b).addClass("disabled"),$.get("/getdatasourceconnect/"+a,function(a,c){"success"==c||alertf("网站出错，请联系管理员"),$(b).removeClass("loading"),$(b).removeClass("disabled");var d=$.parseJSON(a);return"3"==d.isok?(location.href="/",!1):(alertf(d.con),void 0)})}function shuaDatasource(){$.get("/getdatasource/"+tid,function(a,b){var c,d,e,f,g;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.datasources,e="",d.length>0){for(f=0;f<d.length;f++)g="'"+d[f].name+"','"+d[f].des+"','"+d[f].link+"','"+d[f].dataname+"','"+d[f].type+"','"+d[f].user+"'",e+="<tr><td>"+(f+1)+"</td>\n"+"                        <td>"+d[f].name+"</td>\n"+"                        <td>"+d[f].des+"</td>\n"+"                        <td>"+d[f].link+"</td>\n"+"                        <td>"+d[f].dataname+"</td>\n"+"                        <td>"+("1"==d[f].type?"Mysql":"Sqlserver")+"</td>\n"+'                        <td><button class="ui basic  button" onclick=\'datasourcecon('+d[f].id+",this)' >测试</button></td>\n"+'                        <td><button class="ui  circular basic icon button" onclick="updatedatasource('+d[f].id+","+g+')" title="修改数据库"><i class="paint brush icon"></i></button>\n'+'                        <button class="ui circular basic icon button" onclick=\'removedatasource('+d[f].id+')\' title="删除数据库"><i class="remove circle icon red"></i></button></td> </tr>';$("#datasourceid").html(e),$("table").tablesort()}else $("#datasourceid").html("无相关信息")})}function shuaele(){$.get("/gele/"+pid+"/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.elements,elements1=d,e="",d.length>0){for(f=0;f<d.length;f++)e+="                    <tr>\n\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+d[f].name+"</td>\n"+"                        <td  >"+in2st4lo(d[f].locationMethod)+"</td>\n"+"                        <td  >"+d[f].value.replace(/%78/g,'"')+"</td>\n"+"                        <td  >"+("-1"!=d[f].topage)+"</td>\n"+"                        <td  >"+("1"==d[f].isframe)+"</td>\n"+'                        <td  ><button class="ui  circular basic icon button" onclick=\'updateele('+d[f].id+')\' title="修改元素"><i class="paint brush icon"></i></button>\n'+'                            <button class="ui circular basic icon button" onclick=\'removeele('+d[f].id+')\' title="删除元素"><i class="remove circle icon red"></i></button></td>\n'+"                    </tr>\n";$("#eleid").html(e),$("table").tablesort()}else $("#eleid").html("无相关信息")})}function topage(){$("#mpage").click()}function shuaeleall(){$.get("/gele/-1/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.elements,elements1=d,e="",d.length>0){for(f=0;f<d.length;f++)e+="                    <tr>\n\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+d[f].pagename+"</td>\n"+"                        <td  >"+d[f].name+"</td>\n"+"                        <td  >"+in2st4lo(d[f].locationMethod)+"</td>\n"+"                        <td  >"+d[f].value+"</td>\n"+"                        <td  >"+("-1"!=d[f].topage)+"</td>\n"+"                        <td  >"+("1"==d[f].isframe)+"</td>\n"+'                        <td  ><button class="ui  circular basic icon button" onclick=\'pid='+d[f].pid+";updateele("+d[f].id+')\' title="修改元素"><i class="paint brush icon"></i></button>\n'+'                            <button class="ui circular basic icon button" onclick=\'pid='+d[f].pid+";removeele("+d[f].id+')\' title="删除元素"><i class="remove circle icon red"></i></button></td>\n'+"                    </tr>\n";$("#eleid").html(e),$("table").tablesort()}else $("#eleid").html("无相关信息")})}function shuaitem(){isshuaitem&&$.get("/gitema",function(a,b){var c,d,e,f,g,h,i;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.items,e="",d.length>0){for(f=0;f<d.length;f++){for(g=new Array,h=new Array,i=0;i<d[f].user.length;i++)g.push(d[f].user[i].name),h.push(d[f].user[i].id);e+="                    <tr>\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+d[f].name+"</td>\n"+"                        <td  >"+d[f].firstpageurl+"</td>\n"+"                        <td  >"+g.join(",")+"</td>\n"+"                        <td  >"+("0"==d[f].isused)+"</td>\n"+'                        <td  ><button class="ui  circular basic icon button" onclick="updateitem('+d[f].id+",'"+d[f].name+"','"+d[f].firstpageurl+"','"+h.join(",")+'\')" title="修改项目"><i class="paint brush icon"></i></button>\n'+'                            <button class="ui circular basic icon button '+("0"==d[f].isused?"disabled":"")+"\" onclick='removeitem("+d[f].id+')\' title="禁用项目"><i class="remove circle icon red"></i></button></td>\n'+"                    </tr>\n"}for($("#titem").html(e),$("table").tablesort(),re=' <option value="">选择用户...</option>',f=0;f<user1.length;f++)"1"==user1[f].isused&&(re+=' <option value="'+user1[f].id+'">'+user1[f].name+"</option>");$("#seuser").html(re)}else $("#titem").html("无相关信息")})}function contains(a,b){var e,c=a.split(","),d=!1;for(e=0;e<c.length;e++)if(c[e]==b){d=!0;break}return d}function shuacaseinfo(a,b){$.get("/getcase/1/"+tid,function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q;if("success"==d||alertf("网站出错，请联系管理员"),e=$.parseJSON(c),"3"==e.isok)return location.href="/",!1;if(0!=e.isok)alertf(e.msg);else if(f=e.cases,h=!1,h=g==a?!1:!0,f.length>0){for(i="",j="",k=!1,l=0;l<f.length;l++){if(m=f[l].id+",'"+f[l].name+"'",n=f[l].id+",'"+f[l].name+"','"+f[l].des+"',"+f[l].important+","+f[l].type,o="1"==f[l].type,p=1==f[l].ispass,h){switch(q=!1,b){case"name":q=f[l].name.indexOf(a)>=0?!0:!1;break;case"des":q=f[l].des.indexOf(a)>=0?!0:!1;break;case"label":q=contains(f[l].label,a)?!0:!1;break;case"imp":q=f[l].important==a?!0:!1}k=q||k,q?(j+="                    <tr>\n                        <td  >Y</td>\n                        <td  >"+(o?"UI_":"IN_")+f[l].name+"</td>\n"+"                        <td  >"+f[l].des+"</td>\n"+"                        <td  >"+int2imp(f[l].important)+"</td>\n"+'                        <td  ><button class="ui  circular basic icon button" onclick=\'lookstep('+f[l].id+","+o+')\' title="查看操作步骤"><i class="indent icon"></i></button></td>\n'+'                        <td  ><button class="ui  circular basic icon button" onclick=\'lookpre('+f[l].id+')\' title="查看预置条件"><i class="grid layout icon"></i></button></td>\n'+'                        <td  > <button class="ui circular basic icon button " onclick="looklabel('+m+",'"+f[l].label+'\')" title="查看标签"><i class="tags icon   yellow"></i></button><button class="ui  circular basic icon button" onclick="updatecase('+n+')" title="修改用例"><i class="paint brush icon"></i></button><button class="ui  circular basic icon button" onclick="copycase('+m+')" title="复制/粘贴用例"><i class="copy icon"></i></button>'+'                            <button class="ui circular basic icon button " onclick=\'removecase('+f[l].id+')\' title="删除用例"><i class="remove circle icon red"></i></button></td>'+'<td><button class="ui circular basic icon button " onclick="runcase('+m+')" title="运行用例"><i class="play icon green"></i></button>',j+=p?'<button class="ui circular basic icon button " onclick="canruncase('+f[l].id+',2)" title="从总库移除"><i class=" remove circle icon "></i></button></td></tr>\n':'<button class="ui circular basic icon button " onclick="canruncase('+f[l].id+',1)" title="加入总库"><i class=" checkmark icon "></i></button></td></tr>\n'):(i+="                    <tr>\n                        <td  >N</td>\n                        <td  >"+(o?"UI_":"IN_")+f[l].name+"</td>\n"+"                        <td  >"+f[l].des+"</td>\n"+"                        <td  >"+int2imp(f[l].important)+"</td>\n"+'                        <td  ><button class="ui  circular basic icon button" onclick=\'lookstep('+f[l].id+","+o+')\' title="查看操作步骤"><i class="indent icon"></i></button></td>\n'+'                        <td  ><button class="ui  circular basic icon button" onclick=\'lookpre('+f[l].id+')\' title="查看预置条件"><i class="grid layout icon"></i></button></td>\n'+'                        <td  > <button class="ui circular basic icon button " onclick="looklabel('+m+",'"+f[l].label+'\')" title="查看标签"><i class="tags icon   yellow"></i></button><button class="ui  circular basic icon button" onclick="updatecase('+n+')" title="修改用例"><i class="paint brush icon"></i></button><button class="ui  circular basic icon button" onclick="copycase('+m+')" title="复制/粘贴用例"><i class="copy icon"></i></button>'+'                            <button class="ui circular basic icon button " onclick=\'removecase('+f[l].id+')\' title="删除用例"><i class="remove circle icon red"></i></button></td>'+'<td><button class="ui circular basic icon button " onclick="runcase('+m+')" title="运行用例"><i class="play icon green"></i></button>',i+=p?'<button class="ui circular basic icon button " onclick="canruncase('+f[l].id+',2)" title="从总库移除"><i class=" remove circle icon "></i></button></td></tr>\n':'<button class="ui circular basic icon button " onclick="canruncase('+f[l].id+',1)" title="加入总库"><i class=" checkmark icon "></i></button></td></tr>\n')}else i+="                    <tr>\n                        <td  >"+(l+1)+"</td>\n"+"                        <td  >"+(o?"UI_":"IN_")+f[l].name+"</td>\n"+"                        <td  >"+f[l].des+"</td>\n"+"                        <td  >"+int2imp(f[l].important)+"</td>\n"+'                        <td  ><button class="ui  circular basic icon button" onclick=\'lookstep('+f[l].id+","+o+')\' title="查看操作步骤"><i class="indent icon"></i></button></td>\n'+'                        <td  ><button class="ui  circular basic icon button" onclick=\'lookpre('+f[l].id+')\' title="查看预置条件"><i class="grid layout icon"></i></button></td>\n'+'                        <td  > <button class="ui circular basic icon button " onclick="looklabel('+m+",'"+f[l].label+'\')" title="查看标签"><i class="tags icon   yellow"></i></button><button class="ui  circular basic icon button" onclick="updatecase('+n+')" title="修改用例"><i class="paint brush icon"></i></button><button class="ui  circular basic icon button" onclick="copycase('+m+')" title="复制/粘贴用例"><i class="copy icon"></i></button>'+'                            <button class="ui circular basic icon button " onclick=\'removecase('+f[l].id+')\' title="删除用例"><i class="remove circle icon red"></i></button></td>'+'<td><button class="ui circular basic icon button " onclick="runcase('+m+')" title="运行用例"><i class="play icon green"></i></button>',i+=p?'<button class="ui circular basic icon button " onclick="canruncase('+f[l].id+',2)" title="从总库移除"><i class=" remove circle icon "></i></button></td></tr>\n':'<button class="ui circular basic icon button " onclick="canruncase('+f[l].id+',1)" title="加入总库"><i class=" checkmark icon "></i></button></td></tr>\n';k=!0}$("#caseid").html(j+i)}else $("#caseid").html("无相关信息")})}function copycase(a,b){if(0!=copyid){if(copyid==a)return copyid=0,alertf("取消复制"),void 0;confirm("用例"+copyname+"将覆盖用例"+b+"，请确认？")&&$.get("/copycase/"+a+"/"+copyid,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),copyid=0,void 0)})}else copyid=a,copyname=b,alertf("用例"+b+"复制成功")}function canruncase(a,b){confirm("你确定要这样操作吗？")&&$.post("/addcase2all",{id:a,ispass:b},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuacaseinfo(),alertf(c.msg),void 0)})}function looklabel(a,b,c){$("#labeltitle").html(b),labelid=a,$.get("/getlabel/"+tid,function(a,b){var d,e,f,g,h;if("success"==b||alertf("网站出错，请联系管理员"),d=$.parseJSON(a),"3"==d.isok)return location.href="/",!1;if("0"!=d.isok)alertf(d.msg);else{for(e=d.labels,f="",g=0;g<e.length;g++)f+='<option value="'+e[g].id+'" >'+e[g].name+"</option>";if($("#labelcon").html(f),"null"!=c)for(h=c.split(","),g=0;g<h.length;g++)$("#labelcon").dropdown("set selected",h[g])}}),$("#modal11").modal("show")}function int2imp(a){switch(a){case"1":return"高";case"2":return"中";case"3":return"低";default:return"no"}}function gettid(a,b){0>tid||tid==a?tid=a:(tid=a,$("#context").html('<h2 class="ui center aligned header" style="margin-top: 7%">已切换到项目：'+b+"</h2>"))}function removepage(a){confirm("你确定要删除吗？")&&$.get("/removepage/"+a+"/"+tid,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),shuapage(),void 0)})}function removeele(a){confirm("你确定要删除吗？")&&$.get("/removeele/"+a+"/"+pid+"/"+tid,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuaele(),alertf(c.msg),void 0)})}function removecase(a){confirm("你确定要删除吗？")&&$.get("/removecase/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuacaseinfo(),alertf(c.msg),void 0)})}function removecasehome(a){confirm("你确定要删除吗？")&&$.get("/removecasehome/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuacasehome(),alertf(c.msg),void 0)})}function removelabel(a){confirm("你确定要删除吗？")&&$.get("/removelabel/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shualabel(),alertf(c.msg),void 0)})}function removedatasource(a){confirm("你确定要删除吗？")&&$.get("/removedatasource/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuaDatasource(),alertf(c.msg),void 0)})}function removeuser(a){confirm("你确定要禁用吗？")&&$.get("/removeuser/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),shuauser(),void 0)})}function removeitem(a){confirm("你确定要禁用吗？")&&$.get("/removeitem/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),isshuaitem=!0,shuaitem(),void 0)})}function updatepage(a,b){$("#kanbujian").text(a),$("#pagenameadd").val(b.parentNode.parentNode.getElementsByTagName("td")[1].innerHTML),$("#pagetitleadd").val(b.parentNode.parentNode.getElementsByTagName("td")[2].innerHTML),$("#modal1").modal("show")}function updatecasehome(a,b,c){homeid=a,$("#homename").val(b),$("#homedes").val(c),$("#modal9").modal("show")}function updatelabel(a,b,c){labelid=a,$("#labelname").val(b),$("#labeldes").val(c),$("#modal10").modal("show")}function updateuser(a,b,c,d){ass2=a,$("#ueamil").val(d),$("#uname").val(c),"1"==b&&$("#isman").checkbox("set checked"),$("#modal3").modal("show")}function updateitem(a,b,c,d){var e,f;for(ass3=a,$("#additemname").val(b),$("#additemurl").val(c),$("#seuser").dropdown("clear"),e=d.split(","),f=0;f<e.length;f++)$("#seuser").dropdown("set selected",e[f]);$("#modal4").modal("show")}function updatedatasource(a,b,c,d,e,f,g){adddatasource=a,$("#ddname").val(e),$("#ddes").val(c),$("#duser").val(g),$("#dname").val(b),$("#dlink").val(d),$("#sedtype").dropdown("set selected",f),$("#modal7").modal("show")}function updatecase(a,b,c,d,e){ass4=a,$("#addcasename").val(b),$("#addcasedes").val(c),$("#cc22").dropdown("set selected",d),$("#typeele").dropdown("set selected",e),$("#typeele").addClass("disabled"),$("#modal5").modal("show")}function searchcase(){var a=$.trim($("#seaca").val()),b=$("#secon").val();""==a?$("#seaca").css("background","yellow"):shuacaseinfo(a,b)}function backclear(a){$("#"+a).css("background","white")}function getusedlabel(){$.get("/getusedlabel/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(d='  <select class="ui compact selection dropdown"  id=\'seaca\' style="          padding-bottom: 1px;          padding-top: 1px;          ">\n',0!=c.isok);else if(e=c.labels,e.length>0)for(d+='    <option  selected="" value="'+e[0].id+'">'+e[0].name+"</option>\n",f=1;f<e.length;f++)d+='    <option   value="'+e[f].id+'">'+e[f].name+"</option>\n";d+="  </select>\n",$("#seq").html(d)})}function changesearchcase(){switch($("#secon").val()){case"name":$("#seq").html(' <input type="text" id=\'seaca\' onclick="backclear(\'seaca\')" placeholder="Search...">');break;case"des":$("#seq").html(' <input type="text" id=\'seaca\' onclick="backclear(\'seaca\')" placeholder="Search...">');break;case"label":getusedlabel();break;case"imp":$("#seq").html('  <select class="ui compact selection dropdown"  id=\'seaca\' style="          padding-bottom: 1px;          padding-top: 1px;          ">\n    <option  selected="" value="1">高</option>\n    <option  value="2">中</option>\n    <option value="3">低</option>\n  </select>\n')}}function clickcase(){var a,b;1>tid?alertf("请先选择项目~"):(forfirstfun(),pid=0,a='<div class="ui action input"><div id=\'seq\'>\n  <input type="text" id=\'seaca\' onclick="backclear(\'seaca\')" placeholder="Search..."></div>\n  <select class="ui compact selection dropdown" onchange=\'changesearchcase()\' id=\'secon\' style="          padding-bottom: 1px;          padding-top: 1px;          ">\n    <option  selected="" value="name">名称</option>\n    <option  value="des">描述</option>\n    <option value="label">标签</option>\n    <option value="imp">重要级</option>\n  </select>\n  <div type="submit" class="ui button" onclick=\'searchcase()\'>搜索</div>\n</div>',b=base('                        <th style="width: 40px">#</th>\n                        <th  style="width: 25%">用例名称</th>\n                        <th   style=\'min-width: 100px\'>用例描述</th>\n                        <th   style=\'width: 60px\'>重要等级</th>\n                        <th style="width: 60px">查看步骤</th>\n                        <th style="width: 60px">预置条件</th>\n                        <th style="width: 80px">操作按钮</th><th style="width: 80px">执行用例</th>',8,"addcase()","添加用例","caseid"),$("#context").html(a+b),shuacaseinfo(),$("table").tablesort())}function clickcasehome(){if(1>tid)alertf("请先选择项目~");else{forfirstfun();var a=base('                        <th style="width: 40px">#</th>\n                        <th  style="width: 25%">小库名称</th>\n                        <th   style=\'min-width: 100px\'>小库描述</th>\n                        <th style="width: 60px">查看用例</th>\n                        <th style="width: 80px">操作按钮</th>',5,"addcasehome()","添加用例小库","casehomeid");$("#context").html(a),shuacasehome()}}function addcasehome(){homeid=0,$("#modal9").modal("show")}function addlabel(){labelid=0,$("#modal10").modal("show")}function shuacasehome(){$.get("/getcasehome/"+tid,function(a,b){var c,d,e,f,g,h;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.casehomes,d.length>0){for(e="",f=0;f<d.length;f++)g="'"+d[f].cids+"',"+d[f].id,h=d[f].id+",'"+d[f].name+"','"+d[f].des+"'",e+="                    <tr>\n                        <td  >"+(f+1)+"</td>\n"+"                        <td  >"+d[f].name+"</td>\n"+"                        <td  >"+d[f].des+"</td>\n"+'                        <td  ><button class="ui  circular basic icon button" onclick="choosecase('+g+')" title="查看操作步骤"><i class="indent icon"></i></button></td>\n'+'                        <td  ><button class="ui  circular basic icon button" onclick="updatecasehome('+h+')" title="修改用例"><i class="paint brush icon"></i></button>\n'+'                            <button class="ui circular basic icon button " onclick=\'removecasehome('+d[f].id+')\' title="删除用例"><i class="remove circle icon red"></i></button></td>'+"                    </tr>\n";$("#casehomeid").html(e),$("table").tablesort()}else $("#casehomeid").html("无相关信息")})}function clickdatasource(){if(1>tid)alertf("请先选择项目~");else{forfirstfun();var a=base('                        <th style="width: 40px">#</th>\n                        <th  style="width: 25%">数据库名称</th>\n                        <th   style=\'min-width: 40px\'>描述</th>\n                        <th   style=\'width: 140px\'>连接地址</th>\n                        <th   style=\'width: 100px\'>数据库</th>\n                        <th style="width: 80px">数据库类型</th>\n                        <th style="width: 80px">连接测试</th>\n                        <th style="width: 80px">操作</th>\n',8,"addds()","添加数据库","datasourceid");$("#context").html(a),shuaDatasource(),$("table").tablesort()}}function clickpage(){if(1>tid)alertf("请先选择项目~");else{forfirstfun(),mele=0;var a=base('                        <th style="width: 80px">#</th>\n                        <th  style="width: 25%">页面名称</th>\n                        <th  style="min-width: 30em;" >页面标题</th>\n                        <th style="width: 80px">查看元素</th>\n                        <th style="width: 80px">操作</th>\n',5,"addpage()","添加页面","tpageid");$("#context").html(a),shuapage()}}function showlabel(a){var c,b=$(".labelz");for(c=0;c<b.length;c++)0==a?$(b[c]).css("display","table-row"):$(b[c]).hasClass("label"+a)?$(b[c]).css("display","table-row"):$(b[c]).css("display","none")
}function choosecase(a,b){forfirstfun(),$.get("/getusedlabel/"+tid,function(c,d){var e,f,g,h,i,j;if("success"==d||alertf("网站出错，请联系管理员"),e=$.parseJSON(c),"3"==e.isok)return location.href="/",!1;if(0!=e.isok)alertf(e.msg);else{for(f=e.labels,g="",h="",i=0;i<f.length;i++)g+='      <div class="item" onclick=\'showlabel('+f[i].id+")'>\n"+f[i].name+"      </div>\n";g+="      <div class=\"item\" onclick='showlabel(0)'>\n 查看全部      </div>\n",g+="      <div class=\"item\" onclick='showlabel(null)'>\n 查看无标签      </div>\n",h='<div class="ui horizontal compact segments">\n  <div class="ui segment">\n    <div class="ui positive check button">全选</div><div class="ui negative uncheck button">全部取消</div><div class="ui toggle button">反转</div> <div class="ui  floated small primary labeled icon button" onclick=\'returncasehome()\' ><i class="reply icon"></i>返回</div> </div>\n  <div class="ui segment"  style=" font-size: larger;">\n<label>重要等级：</label>    <div class="ui test checkbox"> <input type="checkbox" id=\'impc1\' onchange=\'checkimp(this)\'> <label>高&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label> </div><div class="ui test checkbox"> <input type="checkbox"  id=\'impc2\' onchange=\'checkimp(this)\'> <label>中&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label> </div><div class="ui test checkbox"> <input type="checkbox" id=\'impc3\' onchange=\'checkimp(this)\'> <label>低</label> </div><div class="ui inline dropdown" style=\'margin-left: 8px\' id=\'selabel\'>\n    <div class="text">\n      \n      选择标签\n    </div>\n    <i class="dropdown icon"></i>\n    <div class="menu" id=\'labelmenu\'>\n'+g+"    \n"+"    </div>\n"+"  </div>"+' <div class="ui  floated small primary labeled icon button" onclick=\'addcids('+b+')\' ><i class="radio icon"></i>选择完毕</div>'+"  </div>\n"+"</div>",j=base('                        <th style="width: 40px">#</th>\n                        <th  style="width: 25%">用例名称</th>\n                        <th  style="min-width: 30em;" >用例描述</th>\n                        <th style="width: 80px">重要等级</th>\n',4,"addcids("+b+")","选择完毕","testcaseid","2a2"),$("#context").html(h+j),$("#selabel").dropdown(),shuatestcase(-1,a)}})}function returncasehome(){$("#mcasehome").click()}function addcids(a){var d,b=$(".imp.checked"),c=[];for(d=0;d<b.length;d++)c.push(b.get(d).id);0==c.length?alertf("请勾选用例！"):(new Date,$.post("/updatecids",{cids:c.join(","),id:a},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),$("#mcasehome").click(),void 0)}))}function clicktest(){if(1>tid)alertf("请先选择项目~");else{forfirstfun();var a='<div class="ui horizontal compact segments">\n  <div class="ui segment">\n    <div class="ui positive check button">全选</div><div class="ui negative uncheck button">全部取消</div><div class="ui toggle button">反转</div><div class="ui  right floated selection dropdown">\n  <input type="hidden" name="casehome" onchange=\'changecasehome(this)\'>\n  <i class="dropdown icon" ></i>\n  <div class="default text">选择用例库...</div>\n  <div class="menu" id=\'casehomemenu\'>\n  </div>\n</div>  </div>\n  <div class="ui segment"  style=" font-size: larger;">\n<label>重要等级：</label>    <div class="ui test checkbox"> <input type="checkbox" id=\'impc1\' onchange=\'checkimp(this)\'> <label>高&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label> </div><div class="ui test checkbox"> <input type="checkbox"  id=\'impc2\' onchange=\'checkimp(this)\'> <label>中&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label> </div><div class="ui test checkbox"> <input type="checkbox" id=\'impc3\' onchange=\'checkimp(this)\'> <label>低</label> </div><div class="ui inline dropdown" style=\'margin-left: 8px\' id=\'selabel\'>\n    <div class="text">\n      \n      选择标签\n    </div>\n    <i class="dropdown icon"></i>\n    <div class="menu" id=\'labelmenu\'>\n    \n    </div>\n  </div> <div class="ui  floated small primary labeled icon button" onclick=\'addtestcase()\' ><i class="radio icon"></i>选择完毕</div>  </div>\n</div><div id=\'casehomeid2\'></div>';$("#context").html(a),$(".ui.dropdown").dropdown(),$.get("/getcasehome/"+tid,function(a,b){var c,d,e;if("success"==b||alertf("网站出错，请联系管理员"),re="",c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;for(d=c.casehomes,e=0;e<d.length;e++)re+='    <div class="item" data-value="'+d[e].id+'">'+d[e].name+"</div>";re+='<div class="item" data-value="-1">总库</div>',$("#casehomemenu").html(re)}),$.get("/getusedlabel/"+tid,function(a,b){var c,d,e,f;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else{for(d=c.labels,e="",f=0;f<d.length;f++)e+='      <div class="item" onclick=\'showlabel('+d[f].id+")'>\n"+d[f].name+"      </div>\n";e+="      <div class=\"item\" onclick='showlabel(0)'>\n 查看全部      </div>\n",e+="      <div class=\"item\" onclick='showlabel(null)'>\n 查看无标签      </div>\n",$("#labelmenu").html(e)}})}}function changecasehome(a){$("#casehomeid2").html(base('                        <th style="width: 40px">#</th>\n                        <th  style="width: 25%">用例名称</th>\n                        <th  style="min-width: 30em;" >用例描述</th>\n                        <th style="width: 80px">重要等级</th>\n',4,"addtestcase()","选择完毕","testcaseid","2a2")),shuatestcase($(a).val())}function clicklook(){if(1>tid)alertf("请先选择项目~");else{forfirstfun(1);var a='<div class="ui top attached tabular   menu">\n  <a class="item active" data-tab="first" id=\'uone\'>尚未运行</a>\n  <a class="item" data-tab="second" id=\'utwo\'>等待运行</a>\n  <a class="item" data-tab="third" id=\'uthree\'>正在运行</a>\n  <a class="item" data-tab="fourth" id=\'ufour\'>运行完成</a>\n</div>\n<div class="ui bottom attached tab segment active" data-tab="first" id=\'lookone\'>loading...</div>\n<div class="ui bottom attached tab segment" data-tab="second" id=\'looktwo\'>loading...</div>\n<div class="ui bottom attached tab segment" data-tab="third" id=\'lookthree\'>loading...</div>\n<div class="ui bottom attached tab segment" data-tab="fourth" id=\'lookfour\'>loading...</div>';$("#context").html(a),$(".menu .item").tab(),shuaseries(),int1=setInterval("shuaseries()",1e4)}}function removeseries(a){confirm("你确定要删除吗？")&&$.get("/removeseries/"+a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuaseries(),alertf(c.msg),void 0)})}function runseries(a){confirm("你确定要运行吗？")&&$.get("/runseries/"+a+"/"+tid,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuaseries(),alertf(c.msg),void 0)})}function pauseseries(a){$.get("/pauseseries/"+a+"/"+tid,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuaseries(),alertf(c.msg),void 0)})}function iseq(a,b){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c].id!=b[c].id||a[c].status!=b[c].status)return!1;return!0}function iseq2(a,b){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c].id!=b[c].id||a[c].status!=b[c].status||a[c].runnum!=b[c].runnum)return!1;return!0}function closerunseries(){var a=$(".sticky").html();a='<div class="ui segment ui sticky">'+a+"</div>",a=a.replace("compress icon","expand icon").replace("缩回","展开").replace("closerunseries","openrunseries").replace("closeid","openid"),$("#segment3").html(a),int2=window.clearInterval(int2),caseresold=[]}function shuarunseries(a,b){var c=a;return $("#uthree").hasClass("active")?($.get("/getcasereslist/"+b,function(a,b){var d,e,f,g;if("success"==b||alertf("网站出错，请联系管理员"),d=$.parseJSON(a),"3"==d.isok)return location.href="/",!1;if(e=d.cases,iseq2(e,caseresold))return 0;for(caseresold=e,f=0;f<e.length;f++){switch(b="",e[f].status){case"0":b="等待运行";break;case"1":b="准备运行";break;case"2":b="正在运行";break;case"3":b="运行完毕"}switch(g="",e[f].res){case"-1":g="0"==e[f].status?"zerode":" teal active";break;case"1":g=" success ";break;case"2":g=" errorde ";break;case"3":g=" warningde "}c+='  <div class="item"> \n    <div class="content">\n      <div class="header">'+e[f].cname+"</div>\n"+'      <div class="description">'+e[f].cdes+"</div>\n"+'	  <div class="ui '+g+'  progress"  data-value="'+e[f].runnum+'" data-total="'+e[f].allnum+'" >\n'+'  <div class="bar">\n'+'    <div class="progress" ></div>\n'+"  </div>\n"+'  <div class="label">'+b+"</div>\n"+"</div>\n"+"    </div>\n"+"  </div>"}c+="</div>",$("#segment3").html(c),$(".ui.sticky").sticky({context:"#segment3",offset:50,bottomOffset:50}),$(".ui.progress").progress({label:"ratio",text:{ratio:"{value} de {total}"}}),$(".warningde").progress("set warning"),$(".errorde").progress("set error")}),void 0):(int2=window.clearInterval(int2),$("#closeid").click(),0)}function openrunseries(a){var b=$("#segment3").html().replace("expand icon","compress icon").replace("展开","缩回").replace("openrunseries","closerunseries").replace("\n","").replace("openid","closeid"),c=b+'<div class="ui relaxed divided list">';shuarunseries(c,a),int2=setInterval("shuarunseries('"+c+"',"+a+")",2e3)}function stopseries(a){confirm("你确定要停止吗？")&&$.get("/stopseries/"+a+"/"+tid,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),void 0)})}function shuaseries(){$.get("/getseries/"+tid,function(a,b){var c,d,e,f,g,h,i;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(d=c.series,e=$(".active.segment").html(),iseq(d,seriesold)&&"loading..."!=e)return 0;if(seriesold=d,f={one:0,two:0,three:0,four:0},g={one:'<div class="ui segments">',two:'<div class="ui segments">',three:"<div class=\"ui segments\" id='segment3'>",four:'<div class="ui segments">'},d.length>0){for(h=0;h<d.length;h++)switch(d[h].status){case"0":f.one++,g.one+="  <div class=\"ui segment\">  <div class=\"ui right floated small   icon button   circular  \" title='删除' style='margin-top: -4px;' onclick='removeseries("+d[h].id+")' ><i class=\"remove red icon\"></i></div><div class=\"ui right floated small   icon button   circular  \"  style='margin-top: -4px;'  title='运行' onclick='runseries("+d[h].id+')\' ><i class="play  green icon"></i></div><p>'+d[h].series+"，创建于："+d[h].ordertime+"</p>  </div>";break;case"1":f.two++,g.two+="  <div class=\"ui segment\">  <div class=\"ui right floated small   icon button   circular  \" style='margin-top: -4px;' title='暂停' onclick='pauseseries("+d[h].id+')\' ><i class="pause icon"></i></div><p>'+d[h].series+"，创建于："+d[h].ordertime+"</p> </div>";break;case"2":f.three++,g.three+="  <div class=\"ui segment ui sticky\"> <div class=\"ui right floated small   icon button   circular  \" style='margin-top: -4px;' id='openid' title='展开' onclick='openrunseries("+d[h].id+")' ><i class=\"expand icon \"></i></div><div class=\"ui right floated small   icon button   circular  \" style='margin-top: -4px;' title='停止' onclick='stopseries("+d[h].id+')\' ><i class="stop icon"></i></div> <p>'+d[h].series+"，创建于："+d[h].ordertime+"</p> </div>\n";break;case"3":f.four++,g.four+="  <div class=\"ui segment\"> <div class=\"ui right floated small   icon button   circular  \" title='删除' style='margin-top: -4px;' onclick='removeseries("+d[h].id+")' ><i class=\"remove red icon\"></i></div> <div class=\"ui right floated small   icon button   circular  \" style='margin-top: -4px;' title='查看' onclick='lookruncase("+d[h].id+')\' ><i class="record icon "></i></div> <p>'+d[h].series+"，创建于："+d[h].ordertime+"</p> </div>\n";break;case"4":f.four++,g.four+="  <div class=\"ui orange inverted segment\"> <div class=\"ui right floated small   icon button   circular  \" title='删除' style='margin-top: -4px;' onclick='removeseries("+d[h].id+")' ><i class=\"remove red icon\"></i></div> <div class=\"ui right floated small   icon button   circular  \" style='margin-top: -4px;' title='查看' onclick='lookruncase("+d[h].id+')\' ><i class="record icon "></i></div> <p>'+d[h].series+"，创建于："+d[h].ordertime+",问题：有用例步骤错误，请检查</p> </div>\n";break;case"5":f.four++,g.four+="  <div class=\"ui yellow inverted segment\"> <div class=\"ui right floated small   icon button   circular  \" title='删除' style='margin-top: -4px;' onclick='removeseries("+d[h].id+")' ><i class=\"remove red icon\"></i></div> <div class=\"ui right floated small   icon button   circular  \" style='margin-top: -4px;' title='查看' onclick='lookruncase("+d[h].id+')\' ><i class="record icon "></i></div> <p>'+d[h].series+"，创建于："+d[h].ordertime+",强制停止</p> </div>\n"}i=f.one,i>0?($("#uone").html('<div class="floating ui red label">'+i+"</div>尚未运行"),$("#lookone").html(g.one+"</div>")):($("#uone").html("尚未运行"),$("#lookone").html("没有用例需要运行")),i=f.two,i>0?($("#utwo").html('<div class="floating ui red label">'+i+"</div>等待运行"),$("#looktwo").html(g.two+"</div>")):($("#utwo").html("等待运行"),$("#looktwo").html("没有用例等待运行")),i=f.three,i>0?($("#uthree").html('<div class="floating ui red label">running</div>正在运行'),$("#lookthree").html(g.three+"</div>")):($("#uthree").html('<div class="floating ui teal label">none</div>正在运行'),$("#lookthree").html("没有用例正在运行")),i=f.four,i>0?($("#ufour").html('<div class="floating ui teal  label">'+i+"</div>运行完成"),$("#lookfour").html(g.four+"</div>")):($("#ufour").html("运行完成"),$("#lookfour").html("没有用例运行完成"))}else $("#lookone").html("没有用例需要运行"),$("#looktwo").html("没有用例等待运行"),$("#lookthree").html("没有用例正在运行"),$("#lookfour").html("没有用例运行完成"),$("#uone").html("尚未运行"),$("#ufour").html("运行完成")})}function checkimp(a){var b=a.id;switch(b){case"impc1":$(a).attr("id","impc4"),$(".imp1").checkbox("check");break;case"impc2":$(a).attr("id","impc5"),$(".imp2").checkbox("check");break;case"impc3":$(a).attr("id","impc6"),$(".imp3").checkbox("check");break;case"impc4":$(a).attr("id","impc1"),$(".imp1").checkbox("uncheck");break;case"impc5":$(a).attr("id","impc2"),$(".imp2").checkbox("uncheck");break;case"impc6":$(a).attr("id","impc3"),$(".imp3").checkbox("uncheck")}}function shuatestcase(a,b){-1==a?$.get("/getcase/2/"+tid,function(a,c){var d,e,f,g,h,i,j,m;if("success"==c||alertf("网站出错，请联系管理员"),d=$.parseJSON(a),"3"==d.isok)return location.href="/",!1;if(0!=d.isok)alertf(d.msg);else if(e=d.cases,e.length>0){for(f="",g=0;g<e.length;g++){for(h="labelz ",i=e[g].label.split(","),j=0;j<i.length;j++)h+=" label"+i[j];e[g].id+",'"+e[g].name+"'",e[g].id+",'"+e[g].name+"','"+e[g].des+"',"+e[g].important,f+="                    <tr class='"+h+"'>\n"+"                        <td  >"+' <div class="column">\n'+'    <div class="ui test checkbox  imp imp'+e[g].important+"\" id='"+e[g].id+"'>\n"+'      <input type="checkbox" >\n'+"      <label> </label>\n"+"    </div>\n"+"  </div>"+"</td>\n"+"                        <td  >"+e[g].name+"</td>\n"+"                        <td  >"+e[g].des+"</td>\n"+"                        <td  >"+int2imp(e[g].important)+"</td>\n"}if($("#testcaseid").html(f),$("table").tablesort(),$(".test.checkbox").checkbox("attach events",".toggle.button"),$(".test.checkbox").checkbox("attach events",".check.button","check"),$(".test.checkbox").checkbox("attach events",".uncheck.button","uncheck"),"undefined"!=typeof b)for(m=b.split(","),g=0;g<m.length;g++)$("#"+m[g]).checkbox("check")}else $("#testcaseid").html("无相关信息")}):$.get("/getcase/2/t"+a,function(a,b){var c,d,e,f,i,j,k;if("success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf(c.msg);else if(d=c.cases,d.length>0){for(e="",f=0;f<d.length;f++){for(d[f].id+",'"+d[f].name+"'",d[f].id+",'"+d[f].name+"','"+d[f].des+"',"+d[f].important,i="labelz ",j=d[f].label.split(","),k=0;k<j.length;k++)i+=" label"+j[k];e+="                    <tr class='"+i+"'>\n"+"                        <td  >"+' <div class="column">\n'+'    <div class="ui test checkbox  imp imp'+d[f].important+"\" id='"+d[f].id+"'>\n"+'      <input type="checkbox" >\n'+"      <label> </label>\n"+"    </div>\n"+"  </div>"+"</td>\n"+"                        <td  >"+d[f].name+"</td>\n"+"                        <td  >"+d[f].des+"</td>\n"+"                        <td  >"+int2imp(d[f].important)+"</td>\n"}$("#testcaseid").html(e),$("table").tablesort(),$(".test.checkbox").checkbox("attach events",".toggle.button"),$(".test.checkbox").checkbox("attach events",".check.button","check"),$(".test.checkbox").checkbox("attach events",".uncheck.button","uncheck")}else $("#testcaseid").html("无相关信息")})}function addtestcase(){var c,d,a=$(".imp.checked"),b=[];for(c=0;c<a.length;c++)b.push(a.get(c).id);0==b.length?alertf("请勾选用例！"):(d=new Date,$.post("/addseries",{tid:tid,cids:b.join(","),seriesName:d.toLocaleDateString()+"-"+d.getHours()+"-"+d.getMinutes()+"运行"},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),void 0)}))}function clickelemnet(){if(1>tid)alertf("请先选择项目~");else{forfirstfun(),mele=1;var a=base('<th style="width: 40px">#</th>\n                        <th style="width: 15%">页面名称</th>                        <th style="width: 15%">元素名称</th>                        <th style="width: 80px">定位方式</th>                        <th style="min-width: 30em;">定位值</th>                        <th style="width: 80px">关联页面</th>                        <th style="width: 80px">Frame</th>                        <th style="width: 80px">操作</th>',8,"topage()","跳转至页面","eleid");$("#context").html(a),shuaeleall()}}function lookstep(a,b){var c;cid=a,b?(c=base('                        <th style="width: 60px">步骤</th>\n                        <th  style="width: 80px">所属页面</th>\n                        <th  style="width: 15%" >页面元素</th>\n                        <th  style="width: 150px" >操作</th>\n                        <th style="min-width:100px">输入值</th>\n                        <th style="width:80px">期望值</th>\n                        <th style="width: 120px">操作</th>\n',7,"wancheng()","完成","stepid","2a2"),$("#context").html(c),shuastep()):(c=' <div class="ui segment" style=\'margin: 1rem\'><div class="ui form">\n            <div class="field">\n                <div class="fields">\n\n                    <div class="two wide field">\n                        <div class="ui fluid search selection  dropdown" id=\'sehttp\'>\n                            <input type="hidden" name="country" id=\'http\'>\n                            <i class="dropdown icon"></i>\n                            <div class="default text">发送方式</div>\n                            <div class="menu" >\n                                <div class="item" data-value="1">get</div>\n                                <div class="item" data-value="2">post</div>\n\n\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="fourteen wide field " id=\'urlid\'>\n                        <input type="text"   placeholder="链接:http(s):" id=\'urlv\'>\n                    </div>\n\n                </div>\n            <div class="field">\n<label>传输内容，如有头文件，使用格式：HEAD{xxx:aaa&ccc:222}xxx=111&ccc=222</label><textarea id=\'areaid\'></textarea>                </div>\n            <div class="field">\n                <label>值</label>\n                <div class="fields">\n\n                    <div class="two wide field">\n                        <div class="ui fluid search selection  dropdown" id=\'setype3\'>\n                            <input type="hidden" name="country" id=\'type3\'>\n                            <i class="dropdown icon"></i>\n                            <div class="default text">选择类型</div>\n                            <div class="menu">\n                                <div class="item" data-value="1">等于</div>\n                                <div class="item" data-value="2">不等于</div>\n                                <div class="item" data-value="3">包含</div>\n                                <div class="item" data-value="4">不包含</div>\n\n\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="eleven wide field " id=\'input2\'>\n                        <input type="text"   placeholder="值的内容" id=\'inputv3\'>\n                    </div>\n                    <div class="two wide field " id=\'input2\'>\n<div class="ui buttons">\n<button class="ui small button" onclick="$(\'#mcase\').click()">\n  返回\n</button>  <div class="or"></div>\n<button class="ui small primary button" onclick=\'updatehttpcase('+cid+")'>\n"+"  保存\n"+"</button>"+"</div>"+"                    </div>\n"+"\n"+"                </div>\n"+"            </div>\n"+"    </div></div>",$("#context").html(c),$(".ui.dropdown").dropdown(),$.get("/gethttpcase/"+cid,function(a,b){var c,d;return"success"==b||alertf("网站出错，请联系管理员"),c=$.parseJSON(a),"3"==c.isok?(location.href="/",!1):(0!=c.isok?alertf(c.msg):(d=c.cases,1==d.length&&"-1"!=d[0].type&&($("#sehttp").dropdown("set selected",d[0].type),$("#setype3").dropdown("set selected",d[0].eq),$("#areaid").val(d[0].con.toString().replace(/<br\/>/g,"\n").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&dakuohao1/g,"{").replace(/&dakuohao2/g,"}").replace(/&fanxiegang/g,"\\")),$("#urlv").val(d[0].url),$("#inputv3").val(d[0].value.replace(/<br\/>/g,"\n").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&dakuohao1/g,"{").replace(/&dakuohao2/g,"}").replace(/&fanxiegang/g,"\\")))),void 0)}))}function updatehttpcase(){var b=$("#http").val(),c=$("#type3").val(),d=$.trim($("#areaid").val()),e=$.trim($("#urlv").val()),f=$.trim($("#inputv3").val());""==b||""==f||""==c||""==e?alertf("请输入完整数据！"):$.post("/upatehttp",{type:b,url:e,con:d,eq:c,value:f,cid:cid},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),void 0)})}function lookelement(a){var b=base('<th style="width: 40px"><button class="ui right floated circular basic icon button"  onclick=\'returnpage()\'  title="返回页面"><i class="reply icon"></i></button></th>\n                        <th style="width: 15%">元素名称</th>                        <th style="width: 80px">定位方式</th>                        <th style="min-width: 30em;">定位值</th>                        <th style="width: 80px">关联页面</th>                        <th style="width: 80px">Frame</th>                        <th style="width: 80px">操作</th>',7,"addele()","添加元素","eleid");$("#context").html(b),pid=a,shuaele()}function addpage(){$("#kanbujian").text(0),$("#modal1").modal("show")}function adduser(){ass2=0,$("#ispass").checkbox("check"),$("#modal3").modal("show")}function additem(){ass3=0,$("#modal4").modal("show")}function addcase(){ass4=0,$("#typeele").removeClass("disabled"),$("#modal5").modal("show")}function addds(){adddatasource=0,$("#modal7").modal("show")}function updateele(a){var b,c;for(ass1=a,b=0,c=0;c<elements1.length;c++)if(elements1[c].id==a){b=c;break}$("#ename").val(elements1[b].name),$("#eval").val(elements1[b].value),$("#elo").dropdown("set selected",elements1[b].locationMethod),"1"==elements1[b].isframe&&$("#chisfr").checkbox("check"),"-1"!=elements1[b].num&&$("#enum").val(elements1[b].num),"-1"!=elements1[b].toframe&&($("#chfr").click(),$("#sefr").dropdown("set selected",elements1[b].toframe)),"-1"!=elements1[b].topage&&($("#chwin").click(),$("#sewin").dropdown("set selected",elements1[b].topage)),"-1"!=elements1[b].waitid&&($("#sewait").dropdown("set selected",elements1[b].waitid),$("#waitd").removeClass("disabled"),$("#waitv").val(elements1[b].waitvalue)),$("#modal2").modal("show")}function in2st4type(a){switch(a){case"1":return"按钮";case"2":return"勾选框";case"3":return"提示框";case"4":return"单选";case"6":return"文本";case"7":return"上传";case"8":return"frame";case"9":return"输入框"}}function in2act4typeandcheck(a){switch(a){case"1":return"2,13";case"2":return"4,2,13";case"3":return"13,17";case"4":return"4,13";case"5":return"13";case"6":return"5,13";case"7":return""}}function in2act4type(a){switch(a){case"1":return"1";case"2":return"1,3";case"3":return"6,7";case"4":return"1,3";case"5":return"8,9,10";case"6":return"11,3";case"7":return"12";case"9":return"14,15"}}function in2en4type(a){switch(a){case"1":return"button";case"2":return"checkbox";case"3":return"dialog";case"4":return"radio";case"6":return"text";case"7":return"upload";case"8":return"frame"}}function in2st4action(a){switch(a){case"1":return"点击";case"2":return"输入内容";case"3":return"清除";case"4":return"上传文件";case"5":return"确认（alert）";case"6":return"取消（alert）";case"7":return"存在";case"8":return"获取文本";case"9":return"获取输入值";case"10":return"获取文本（alert）";case"11":return"可用";case"12":return"被选中"}}function in2st4lo(a){switch(a){case"1":return"id";case"2":return"name";case"3":return"tagname";case"4":return"linktext";case"5":return"classname";case"6":return"xpath";case"7":return"css"}}function addele(){ass1=0,$("#modal2").modal("show")}function returnpage(){$("#mpage").click(),pid=0,elements1={}}var tid=-1,pid=0,ass1=0,ass2=0,ass3=0,ass4=0,elements1={},pages1={},user1={},isshuaitem=!0,cid=0,eles2={},acttionnum=0,adddatasource=0,stepid=0,alertftype=0,exptmp={a:-1,b:-1,c:-1,d:-1,e:-1,type:0},pretmp={a:-1,b:-1,c:-1,type:4},homeid=0,mele=0,int1=0,seriesold=[],int2=0,caseresold=[],labelid=0,fileid=0,isadd=0,copyid=0,copyname="";$(document).ready(function(){window.onclick=function(){document.querySelector("#menu3").style.width=0},$.get("/com",function(a){var d,e,f,g,c=$.parseJSON(a);0!=c.isok?(alertf(c.msg),location.href=c.to):(d=Cookies.get("user2"),e="",e="我是管理员"==uncompileStr(d)?'<div class="ui pointing vertical menu overlay">\n    <a class="item "  id="manage" onclick=\'clickmanage()\'>管理 </a>\n    <div class="item">\n        <b>操作</b>\n\n        <div class="ui accordion">\n            <div class="title"><i class="dropdown icon"></i>基础数据 </div>\n            <div class="content menu">\n                <a class="item" id="mdatasource" onclick=\'clickdatasource()\'>数据库设置</a>\n                <a class="item" id="mlabel" onclick=\'clicklabel()\'>标签设置</a>\n                <a class="item" id="mfile" onclick=\'clickfile()\'>上传文件设置</a>\n                <a class="item" id="mfile" onclick=\'clickurl()\'>排除URL设置</a>\n                <!--<a class="item">Subsection 1</a>-->\n                <!--<a class="item">Subsection 1</a>-->\n            </div>\n            <div class="title"><i class="dropdown icon"></i>用例数据</div>\n            <div class="content  menu">\n                <a class="item" id="mcasehome" onclick=\'clickcasehome()\'>管理用例库</a>\n                <a class="item" id="mcase" onclick=\'clickcase()\'>管理用例</a>\n                <!--<a class="item" onclick="alertf(\'尚未设计\')">管理操作</a>-->\n                <a class="item" id="mpage" onclick=\'clickpage()\'>管理页面</a>\n                <a class="item" id="melement" onclick=\'clickelemnet()\'>管理元素</a>\n\n\n            </div>\n\n            <div class="title"><i class="dropdown icon"></i>执行操作</div>\n            <div class="content menu">\n                <a class="item" id="mtest" onclick=\'clicktest()\'>执行测试</a>\n                <a class="item" id="mlook" onclick=\'clicklook()\'>查看进度</a>\n                <!--<a class="item">Subsection 1</a>-->\n            </div>\n            <div class="title"><i class="dropdown icon"></i>日志信息 </div>\n            <div class="content menu">\n                <a class="item" id="mlog" onclick=\'clicklog()\'>操作日志</a>\n                <a class="item" id="mslog" onclick=\'clickslog()\'>报错日志</a>\n                <!--<a class="item">Subsection 1</a>-->\n            </div>\n        </div>\n    </div>\n    <div class="ui dropdown item">其他操作 <i class="dropdown icon"></i> <div class="menu">\n        <div class="item" onclick="hidemenu()">隐藏</div>\n        <div class="item" id=\'al\' onclick="changealert()">切换到console提示</div>\n        <div class="item" onclick=\'showhelp(1)\'>帮助文档</div>\n    </div>\n    </div>\n</div>':'<div class="ui pointing vertical menu overlay">\n    <div class="item">\n        <b>操作</b>\n\n        <div class="ui accordion">\n            <div class="title"><i class="dropdown icon"></i>基础数据 </div>\n            <div class="content menu">\n                <a class="item" id="mdatasource" onclick=\'clickdatasource()\'>数据库设置</a>\n                <a class="item" id="mlabel" onclick=\'clicklabel()\'>标签设置</a>\n                <a class="item" id="mfile" onclick=\'clickfile()\'>上传文件设置</a>\n                <a class="item" id="mfile" onclick=\'clickurl()\'>排除URL设置</a>\n                <!--<a class="item">Subsection 1</a>-->\n                <!--<a class="item">Subsection 1</a>-->\n            </div>\n            <div class="title"><i class="dropdown icon"></i>用例数据</div>\n            <div class="content  menu">\n                <a class="item" id="mcasehome" onclick=\'clickcasehome()\'>管理用例库</a>\n                <a class="item" id="mcase" onclick=\'clickcase()\'>管理用例</a>\n                <!--<a class="item" onclick="alertf(\'尚未设计\')">管理操作</a>-->\n                <a class="item" id="mpage" onclick=\'clickpage()\'>管理页面</a>\n                <a class="item" id="melement" onclick=\'clickelemnet()\'>管理元素</a>\n\n\n            </div>\n\n            <div class="title"><i class="dropdown icon"></i>执行操作</div>\n            <div class="content menu">\n                <a class="item" id="mtest" onclick=\'clicktest()\'>执行测试</a>\n                <a class="item" id="mlook" onclick=\'clicklook()\'>查看进度</a>\n                <!--<a class="item">Subsection 1</a>-->\n            </div>\n        </div>\n    </div>\n    <div class="ui dropdown item">其他操作 <i class="dropdown icon"></i> <div class="menu">\n        <div class="item" onclick="hidemenu()">隐藏</div>\n        <div class="item" id=\'al\' onclick="changealert()">切换到console提示</div>\n        <div class="item" onclick=\'showhelp(0)\'>帮助文档</div>\n    </div>\n    </div>\n</div>',$("#menu1").html(e),$(".ui.modal").modal(),$(".ui.accordion").accordion(),$(".ui.dropdown").dropdown(),f=Cookies.get("user1"),g=uncompileStr(f),$("#username").text(g),$.get("/gitem",function(a){var d,e,f,c=$.parseJSON(a);if("3"==c.isok)return location.href="/",!1;if(0!=c.isok)alertf("项目有异常，请联系管理员。");else{for(d=c.items,e="",f=0;f<d.length;f++)e+='<div class="item"  onclick=\'gettid('+d[f].id+',"'+d[f].name+"\")' >"+d[f].name+"</div>";$("#itemc").html(e)}}))})}),$("#closemodal").click(function(){$("#pagetitleadd").val(""),$("#pagenameadd").val(""),$("#modal1").modal("hide")}),$("#closemodal9").click(function(){$("#homename").val(""),$("#homedes").val(""),$("#modal9").modal("hide")}),$("#closemodal10").click(function(){$("#labelname").val(""),$("#labeldes").val(""),$("#modal10").modal("hide")}),$("#closemodal11").click(function(){$("#labeltitle").html(""),$("#labelcon").dropdown("clear"),$("#modal11").modal("hide")}),$("#closemodal3").click(function(){$("#uname").val(""),$("#ueamil").val(""),$("#isman").checkbox("uncheck"),$("#modal3").modal("hide")}),$("#closemodal4").click(function(){$("#additemname").val(""),$("#additemurl").val(""),$("#seuser").dropdown("clear"),$("#modal4").modal("hide")}),$("#closemodal5").click(function(){$("#addcasename").val(""),$("#addcasedes").val(""),$("#cc22").dropdown("clear"),$("#typeele").dropdown("clear"),$("#modal5").modal("hide")}),$("#closemodal7").click(function(){$("#ddes").val(""),$("#ddname").val(""),$("#dlink").val(""),$("#dname").val(""),$("#dpass").val(""),$("#duser").val(""),$("#sedtype").dropdown("clear"),$("#modal7").modal("hide")}),$("#closemodal6").click(function(){$("#modal6").modal("hide"),$("#yan44").checkbox("check"),exptmp={a:-1,b:-1,c:-1,d:-1,e:-1,type:0}}),$("#closemodal8").click(function(){$("#modal8").modal("hide"),$("#yu44").checkbox("check"),pretmp={a:-1,b:-1,c:-1,type:4}}),$("#closemodal2").click(function(){$("#acc2").accordion("close",0),$("#modal2").modal("hide"),$("#ename").val(""),$("#eval").val(""),$("#enum").val(""),$("#elo").dropdown("clear"),$("#chfr").checkbox("uncheck"),$("#chisfr").checkbox("uncheck"),$("#chwin").checkbox("uncheck"),$("#sefr").dropdown("clear"),$("#sewin").dropdown("clear"),$("#addfrid").addClass("disabled"),$("#sefr").parent().addClass("disabled"),$("#addwinid").addClass("disabled"),$("#sewin").parent().addClass("disabled"),$("#sewait").dropdown("clear"),$("#waitd").addClass("disabled"),$("#waitv").val("")
}),$("#chfr").click(function(){var a,b;if($("#addfrid").hasClass("disabled")){for($("#addfrid").removeClass("disabled"),$("#sefr").parent().removeClass("disabled"),a='<option value="">Frame...</option>',b=0;b<elements1.length;b++)"1"==elements1[b].isframe&&(a+='<option value="'+elements1[b].id+'">'+elements1[b].name+"</option>");$("#sefr").html(a)}else $("#sefr").dropdown("clear"),$("#addfrid").addClass("disabled"),$("#sefr").parent().addClass("disabled")}),$("#chwin").click(function(){var a,b;if($("#addwinid").hasClass("disabled")){for($("#addwinid").removeClass("disabled"),$("#sewin").parent().removeClass("disabled"),a='<option value="">页面...</option>',b=0;b<pages1.length;b++)a+='<option value="'+pages1[b].id+'">'+pages1[b].pagename+"</option>";$("#sewin").html(a)}else $("#sewin").dropdown("clear"),$("#addwinid").addClass("disabled"),$("#sewin").parent().addClass("disabled")}),$("#addpageone7").click(function(){var a=$.trim($("#ddname").val()),b=$.trim($("#ddes").val()),c=$.trim($("#duser").val()),d=$.trim($("#dpass").val()),e=$.trim($("#dname").val()),f=$.trim($("#dlink").val()),g=$("#dtype").val();e.length>0&&a.length>0&&c.length>0&&d.length>0&&f.length>0&&""!=g?$.post("/adddatasource",{name:e,des:b,user:c,type:g,link:f,dataname:a,pass:d,tid:tid,id:adddatasource},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuaDatasource(),alertf(c.msg),$("#closemodal7").click(),void 0)}):alertf("输入信息不全，请检查")}),$("#addpageone6").click(function(){var a="";$("#yan44").checkbox("is checked")?($("#closemodal6").click(),a={a:-1,b:-1,c:-1,d:-1,e:-1,sid:stepid,type:4}):$("#yan11").checkbox("is checked")?a=getyan1():$("#yan22").checkbox("is checked")?a=getyan2():$("#yan33").checkbox("is checked")&&(a=getyan3()),a?$.post("/updateexp",a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),"0"!=c.isok||$("#closemodal6").click(),void 0)}):alertf("输入信息不全，请检查")}),$("#addpageone8").click(function(){var a="";$("#yu44").checkbox("is checked")?($("#closemodal8").click(),a={a:-1,b:-1,c:-1,cid:cid,type:4}):$("#yu11").checkbox("is checked")?a=getyu1():$("#yu22").checkbox("is checked")?a=getyu2():$("#yu33").checkbox("is checked")&&(a=getyu3()),a?$.post("/updatepre",a,function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),"0"!=c.isok||$("#closemodal8").click(),void 0)}):alertf("输入信息不全，请检查")}),$("#addpageone9").click(function(){var a=$.trim($("#homename").val()),b=$.trim($("#homedes").val());a.length>0&&b.length>0?$.post("/addcasehome",{tid:tid,name:a,des:b,type:homeid},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),shuacasehome(),$("#closemodal9").click(),void 0)}):alertf("输入信息不全，请检查")}),$("#addpageone11").click(function(){var a=$("#labelcon").val();a.length>0?$.post("/upatelabel",{tid:tid,id:labelid,labels:a.toString()},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),shuacaseinfo(),$("#closemodal11").click(),void 0)}):alertf("输入信息不全，请检查")}),$("#addpageone10").click(function(){var a=$.trim($("#labelname").val()),b=$.trim($("#labeldes").val());a.length>0&&b.length>0?$.post("/addlabel",{tid:tid,name:a,des:b,type:labelid},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),shualabel(),$("#closemodal10").click(),void 0)}):alertf("输入信息不全，请检查")}),$("#addpageone").click(function(){var a=$("#kanbujian").text(),b=$.trim($("#pagenameadd").val()),c=$.trim($("#pagetitleadd").val());b.length>1&&c.length>1?$.post("/addpage",{item:tid,pagename:b,pagetitle:c,type:a},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(alertf(c.msg),shuapage(),$("#closemodal").click(),void 0)}):alertf("输入信息不全，请检查")}),$("#addpageone3").click(function(){var a=$.trim($("#uname").val()),b=$.trim($("#ueamil").val()),c=$("#isman").checkbox("is checked")?1:0,d=$("#ispass").checkbox("is checked")?1:0;a.length>0&&b.length>0?$.post("/adduser",{name:a,email:b,ismanager:c,type:ass2,ispass:d},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(shuauser(),alertf(c.msg),$("#closemodal3").click(),void 0)}):alertf("输入信息不全，请检查")}),$("#addpageone4").click(function(){var a=$.trim($("#additemname").val()),b=$.trim($("#additemurl").val()),c=$("#seuser").val();a.length>0&&b.length>0?$.post("/additem",{name:a,url:b,users:c.toString(),type:ass3},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(isshuaitem=!0,shuaitem(),alertf(c.msg),$("#closemodal4").click(),void 0)}):alertf("输入信息不全，请检查")}),$("#addpageone5").click(function(){var a=$.trim($("#addcasename").val()),b=$.trim($("#addcasedes").val()),c=$("#cc23").val(),d=$("#typeein").val();a.length>0&&b.length>0&&""!=c&&""!=d?$.post("/addcase",{name:a,des:b,important:c,tid:tid,type:ass4,elety:d},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):(isshuaitem=!0,shuacaseinfo(),alertf(c.msg),$("#closemodal5").click(),void 0)}):alertf("输入信息不全，请检查")}),$("#addpageone2").click(function(){var d,e,f,g,h,i,j,a=$.trim($("#ename").val()),b=$("#elo").val();$("#elo").find("option:selected").text(),d=$.trim($("#eval").val()),e=$("#chisfr").checkbox("is checked")?1:0,f=""==$.trim($("#enum").val())?"-1":$.trim($("#enum").val()),g=-1,h=-1,i=-1,j=0,$("#addfrid").hasClass("disabled")||(g=$("#sefr").val()),$("#addwinid").hasClass("disabled")||(h=$("#sewin").val()),$("#waitd").hasClass("disabled")||(j=$.trim($("#waitv").val()),i=$("#sewait").val()),a.length<1||""===b||d.length<1||""===g||""===h||j.length<1||""===i?alertf("请输入完整信息"):$.post("/addele",{item:tid,elename:a,type:ass1,elelo:b,elevalue:d,pid:pid,topage:h,toframe:g,waitid:i,waitv:j,isframe:e,num:f},function(a,b){"success"==b||alertf("网站出错，请联系管理员");var c=$.parseJSON(a);return"3"==c.isok?(location.href="/",!1):($("#closemodal2").click(),1===mele?shuaeleall():shuaele(),alertf(c.msg),void 0)})}),$("#logout").click(function(){$.get("/logout",function(a){var c=$.parseJSON(a);alertf(c.msg),tid=-1,pid=0,ass1=0,ass2=0,ass3=0,elements1={},pages1={},user1={},isshuaitem=!0,location.href=c.to})});